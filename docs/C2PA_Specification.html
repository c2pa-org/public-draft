<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<title>C2PA Technical Specification</title>
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */

/* Pick a font we're happy with */
@import url("//fonts.googleapis.com/css?family=Noto+Sans:300,600italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700");

article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Noto Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Noto Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Noto Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Noto Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Noto Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^=";http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}

</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>C2PA Technical Specifications</h1>
<div class="details">
<span id="revnumber"> DRAFT 0.6,</span>
<span id="revdate">2021-08-13</span>
<br><span id="revremark">Draft Specification</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_overview">1.1. Overview</a></li>
<li><a href="#_scope">1.2. Scope</a></li>
<li><a href="#_technical_overview">1.3. Technical Overview</a></li>
<li><a href="#_example">1.4. Example</a></li>
<li><a href="#_design_goals">1.5. Design Goals</a></li>
</ul>
</li>
<li><a href="#_glossary">2. Glossary</a>
<ul class="sectlevel2">
<li><a href="#_introductory_terms">2.1. Introductory terms</a></li>
<li><a href="#_assets_and_content">2.2. Assets and Content</a></li>
<li><a href="#_core_aspects_of_c2pa">2.3. Core Aspects of C2PA</a></li>
<li><a href="#_additional_terms">2.4. Additional Terms</a></li>
</ul>
</li>
<li><a href="#_normative_references">3. Normative References</a>
<ul class="sectlevel2">
<li><a href="#_core_formats">3.1. Core Formats</a></li>
<li><a href="#_digital_electronic_signatures">3.2. Digital &amp; Electronic Signatures</a></li>
<li><a href="#_other">3.3. Other</a></li>
</ul>
</li>
<li><a href="#_standard_terms">4. Standard Terms</a></li>
<li><a href="#_assertions">5. Assertions</a>
<ul class="sectlevel2">
<li><a href="#_general">5.1. General</a></li>
<li><a href="#_labels">5.2. Labels</a></li>
<li><a href="#_versioning">5.3. Versioning</a></li>
<li><a href="#_multiple_instances">5.4. Multiple Instances</a></li>
<li><a href="#_assertion_store">5.5. Assertion Store</a></li>
<li><a href="#_embedded_vs_externally_stored_data">5.6. Embedded vs Externally-Stored Data</a></li>
<li><a href="#_redaction_of_assertions">5.7. Redaction of Assertions</a></li>
</ul>
</li>
<li><a href="#_unique_identifiers">6. Unique Identifiers</a>
<ul class="sectlevel2">
<li><a href="#_using_xmp">6.1. Using XMP</a></li>
<li><a href="#_other_identifiers">6.2. Other Identifiers</a></li>
<li><a href="#_uri_references">6.3. URI References</a></li>
</ul>
</li>
<li><a href="#_w3c_verifiable_credentials">7. W3C Verifiable Credentials</a>
<ul class="sectlevel2">
<li><a href="#_general_2">7.1. General</a></li>
<li><a href="#_vcstore">7.2. VCStore</a></li>
<li><a href="#_using_credentials">7.3. Using Credentials</a></li>
<li><a href="#_credential_verification">7.4. Credential Verification</a></li>
</ul>
</li>
<li><a href="#_binding_to_content">8. Binding to Content</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">8.1. Overview</a></li>
<li><a href="#_hard_bindings">8.2. Hard Bindings</a></li>
<li><a href="#_soft_bindings">8.3. Soft Bindings</a></li>
</ul>
</li>
<li><a href="#_claims">9. Claims</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">9.1. Overview</a></li>
<li><a href="#_syntax">9.2. Syntax</a></li>
<li><a href="#_creating_a_claim">9.3. Creating a Claim</a></li>
<li><a href="#_multiple_step_processing">9.4. Multiple Step Processing</a></li>
</ul>
</li>
<li><a href="#_manifests">10. Manifests</a>
<ul class="sectlevel2">
<li><a href="#_use_of_jumbf">10.1. Use of JUMBF</a></li>
<li><a href="#_embedding_manifests_into_assets">10.2. Embedding manifests into assets</a></li>
</ul>
</li>
<li><a href="#_entity_diagram">11. Entity Diagram</a></li>
<li><a href="#_cryptography">12. Cryptography</a>
<ul class="sectlevel2">
<li><a href="#_hashing">12.1. Hashing</a></li>
<li><a href="#_digital_signatures">12.2. Digital Signatures</a></li>
</ul>
</li>
<li><a href="#_trust_model">13. Trust Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_4">13.1. Overview</a></li>
<li><a href="#_identity_of_signers">13.2. Identity of Signers</a></li>
<li><a href="#_signer_credential_trust">13.3. Signer Credential Trust</a></li>
<li><a href="#_identity_in_assertions">13.4. Identity In Assertions</a></li>
<li><a href="#_statements">13.5. Statements</a></li>
</ul>
</li>
<li><a href="#_validation">14. Validation</a>
<ul class="sectlevel2">
<li><a href="#_validate_the_claim">14.1. Validate the Claim</a></li>
<li><a href="#_validate_the_signature">14.2. Validate the Signature</a></li>
<li><a href="#_validate_the_time_stamp_if_present">14.3. Validate the Time Stamp (if present)</a></li>
<li><a href="#_validate_the_credential_revocation_information_if_present">14.4. Validate the Credential Revocation Information (if present)</a></li>
<li><a href="#_validate_the_assertions_in_the_assets_claim">14.5. Validate the Assertions in the Asset&#8217;s Claim</a></li>
<li><a href="#_recursively_verifying_integrity_of_ingredients">14.6. Recursively Verifying Integrity of Ingredients</a></li>
<li><a href="#_inability_to_access_external_uris">14.7. Inability to access external URIs</a></li>
<li><a href="#_visual_look_of_validation">14.8. Visual look of Validation</a></li>
<li><a href="#_validate_the_assets_content">14.9. Validate the Asset&#8217;s Content</a></li>
</ul>
</li>
<li><a href="#_user_experience">15. User Experience</a>
<ul class="sectlevel2">
<li><a href="#_principles">15.1. Principles</a></li>
<li><a href="#_disclosure_levels">15.2. Disclosure Levels</a></li>
<li><a href="#_common_applications_and_use_cases">15.3. Common Applications and Use Cases</a></li>
</ul>
</li>
<li><a href="#_information_security">16. Information security</a>
<ul class="sectlevel2">
<li><a href="#_threats_and_security_considerations">16.1. Threats and Security Considerations</a></li>
<li><a href="#_harms_and_misuse">16.2. Harms and Misuse</a></li>
</ul>
</li>
<li><a href="#_c2pa_standard_assertions">17. C2PA Standard Assertions</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">17.1. Introduction</a></li>
<li><a href="#_use_of_cbor">17.2. Use of CBOR</a></li>
<li><a href="#_assertion_metadata">17.3. Assertion Metadata</a></li>
<li><a href="#_standard_c2pa_assertion_summary">17.4. Standard C2PA Assertion Summary</a></li>
<li><a href="#_data_hash">17.5. Data Hash</a></li>
<li><a href="#_bmff_based_hash">17.6. BMFF-Based Hash</a></li>
<li><a href="#_soft_binding_2">17.7. Soft Binding</a></li>
<li><a href="#_cloud_data">17.8. Cloud Data</a></li>
<li><a href="#_thumbnail">17.9. Thumbnail</a></li>
<li><a href="#_location">17.10. Location</a></li>
<li><a href="#_camera_information">17.11. Camera Information</a></li>
<li><a href="#_actions">17.12. Actions</a></li>
<li><a href="#_ingredient">17.13. Ingredient</a></li>
<li><a href="#_depthmap">17.14. Depthmap</a></li>
<li><a href="#_use_of_schema_org">17.15. Use of Schema.org</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview">1.1. Overview</h3>
<div class="paragraph">
<p>With the digital transformation of information sharing, the ability to trace the provenance of media has become critical. To address this issue at scale for publishers, creators and consumers, the Coalition for Content Provenance and Authenticity (C2PA) has developed this technical specification for establishing content provenance and authenticity. This specification has been, and continues to be, informed by scenarios, workflows and requirements gathered from industry experts and partner organizations, including the <a href="https://www.originproject.info/">Project Origin Alliance</a> and the <a href="https://contentauthenticity.org/">Content Authenticity Initiative (CAI)</a>.</p>
</div>
<div class="paragraph">
<p>This specification is designed to enable global adoption of digital provenance techniques through the creation of a rich ecosystem of digital provenance enabled applications that can be utilized by creators, publishers, media consumers, regulatory bodies, and governmental agencies.</p>
</div>
<div class="paragraph">
<p>In developing this specification, the C2PA is focused on ensuring that it can be used in ways that respect privacy and personal control of data. In addition, this specification promotes tool availability for a wide range of organizations while meeting appropriate security requirements. Additionally, it is important that the specification does not negatively impact content accessibility for consumers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_scope">1.2. Scope</h3>
<div class="paragraph">
<p>This specification describes the technical aspects of the C2PA architecture; a model for storing and accessing cryptographically verifiable metadata whose trustworthiness can be assessed based on a defined trust model. Included in this document is information about how to create and process a C2PA manifest and its components, including the use of digital signature technology for enabling tamper-evidence as well as establishing trust.</p>
</div>
<div class="paragraph">
<p>Other documents from the C2PA will address specific implementation considerations such as expected user experiences and details of our threat and harms modelling.</p>
</div>
</div>
<div class="sect2">
<h3 id="_technical_overview">1.3. Technical Overview</h3>
<div class="paragraph">
<p>C2PA asset metadata comprises a series of statements that cover areas such as asset creation, authorship, edit actions, capture device details, bindings to content and many other subjects. These statements, called <a href="#_assertion">Assertions</a>, make up the provenance of a given asset and represent a series of trust signals that can be used by a human to improve their view of trustworthiness concerning the asset. Assertions are wrapped up with additional information into a digitally signed entity called a <a href="#_claim">Claim</a>.</p>
</div>
<div class="paragraph">
<p>The W3C Verifiable Credentials of individual actors that are involved in the creation of the assertions can be added to the C2PA metadata to provide additional trust signals to the process of assessing trustworthiness of the asset.</p>
</div>
<div class="paragraph">
<p>These assertions, claims, credentials and signatures are all bound together into a verifiable unit called a <a href="#_manifest">Manifest</a> by a hardware or software component called a Claim Generator. The set of manifests, as stored in the asset&#8217;s Manifest Store, represent its provenance data.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/C2PA_Manifest.svg" alt="A C2PA Manifest and its parts" width="333" height="328">
</div>
<div class="title">Figure 1. A C2PA Manifest and its constituent parts</div>
</div>
</div>
<div class="sect2">
<h3 id="_example">1.4. Example</h3>
<div class="paragraph">
<p>A very common scenario will be a user (called an actor in the C2PA ecosystem) taking a photograph with their C2PA-enabled camera (or phone). In that instance, the camera would create a C2PA manifest containing some such assertions including information about the camera itself, a thumbnail of the image and some cryptographic hashes that bind the photograph to the manifest. These assertions would then be listed in the Claim, which would be digitally signed and then the entire manifest would be embedded into the output JPEG.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Photo_Manifest.svg" alt="A C2PA Manifest for a photograph" width="333" height="328">
</div>
<div class="title">Figure 2. Photo manifest</div>
</div>
<div class="paragraph">
<p>A manifest consumer, such as a C2PA validator, could help users to establish the trustworthiness of the asset by first validating the digital signature and its associated credential. It can also check each of the assertions for validity and present the information contained in them, and the signature, to the user in a way that they can then make an informed decision about the trustworthiness of the digital content.</p>
</div>
</div>
<div class="sect2">
<h3 id="_design_goals">1.5. Design Goals</h3>
<div class="paragraph">
<p>In the creation of the C2PA architecture, it was important to establish some clear goals for the work to ensure that the technology was usable across a wide spectrum of hardware and software implementations worldwide and accessible to all.</p>
</div>
<div class="paragraph">
<p>Some of those goals were:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maintain the provenance of the asset across multiple tools, from creation through all subsequent modification and publication/distribution.</p>
</li>
<li>
<p>Support all standard asset formats supported by common authoring tools, across media types such as images, videos, audio, and documents.</p>
</li>
<li>
<p>Create only the minimum required novel technology by relying on well-established techniques.</p>
</li>
<li>
<p>Do not require cloud storage but allow for it.</p>
</li>
<li>
<p>Allow flexibility in the nature of information stored.</p>
</li>
<li>
<p>Allow for information to be subsequently redacted, provided that the author permits it.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary">2. Glossary</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introductory_terms">2.1. Introductory terms</h3>
<div class="sect3">
<h4 id="_actor">2.1.1. Actor</h4>
<div class="paragraph">
<p>A human or non-human (hardware or software) that is participating in the C2PA ecosystem. For example: a camera (capture device), image editing software, cloud service or the person using such tools.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
An organization or group of <em>actors</em> may also be considered an <em>actor</em> in the C2PA ecosystem.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_signer">2.1.2. Signer</h4>
<div class="paragraph">
<p>An actor (human or non-human) whose credential&#8217;s private key is used to sign the claim.  The signer is identified by the subject of the credential.</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim_generator">2.1.3. Claim generator</h4>
<div class="paragraph">
<p>The non-human (hardware or software) <em>actor</em> that generates the <em>claim</em> about an <em>asset</em> as well as the <em>claim signature</em>, thus leading to the <em>asset</em>'s associated <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_manifest_consumer">2.1.4. Manifest consumer</h4>
<div class="paragraph">
<p>An <em>actor</em> who consumes an <em>asset</em> with an associated <em>manifest</em> for the purpose of obtaining the <em>provenance data</em> from the <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_action">2.1.5. Action</h4>
<div class="paragraph">
<p>An operation performed by an <em>actor</em> on an <em>asset.</em> For example, "create", "embed", or "apply filter".</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_assets_and_content">2.2. Assets and Content</h3>
<div class="sect3">
<h4 id="_digital_content">2.2.1. Digital content</h4>
<div class="paragraph">
<p>The portion of an <em>asset</em> that represents the actual content, such as the pixels of an image, along with any additional technical metadata required to understand the content (e.g., a colour profile or encoding parameters).</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset_metadata">2.2.2. Asset metadata</h4>
<div class="paragraph">
<p>The portion of an <em>asset</em> that represents non-technical information about the <em>asset</em> and its <em>digital content</em>, such as location or producer.</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset">2.2.3. Asset</h4>
<div class="paragraph">
<p>A file or stream of data containing <em>digital content</em>, <em>asset metadata</em> and optionally, a C2PA <em>manifest</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For the purposes of this definition, we will extend the typical definition of "file" to include cloud-native and dynamically generated data.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_derived_asset">2.2.4. Derived asset</h4>
<div class="paragraph">
<p>A derived asset is an <em>asset</em> that is created by starting from an existing <em>asset</em> and performing <em>actions</em> to it that modify its <em>digital content</em> and <em>asset metadata</em>.</p>
</div>
<div class="paragraph">
<p><strong>EXAMPLE:</strong> An audio stream that has been shortened or a document where pages have been added.</p>
</div>
</div>
<div class="sect3">
<h4 id="_asset_rendition">2.2.5. Asset rendition</h4>
<div class="paragraph">
<p>A representation of an <em>asset</em> (either as a part of an <em>asset</em> or a completely new <em>asset</em>) where the <em>digital content</em> has had a 'non-editorial transformation' <em>action</em> (e.g., re-encoding or scaling) applied but where the <em>asset metadata</em> has not been modified.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is also referred to as a <em>Facsimile Asset</em>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>EXAMPLE:</strong> A video file that is re-encoded for reduced screen resolution or network bandwidth.</p>
</div>
</div>
<div class="sect3">
<h4 id="_composed_asset">2.2.6. Composed asset</h4>
<div class="paragraph">
<p>A composed asset is an <em>asset</em> that is created by building up a collection of multiple parts or fragments of <em>digital content</em> from one or more other <em>assets</em>. When starting from an existing <em>asset</em>, it is a special case of a <em>derived asset</em> - however a <em>composed asset</em> can also be one that starts from a "blank slate".</p>
</div>
<div class="paragraph">
<p><strong>EXAMPLE:</strong> A video created by importing existing video clips and audio segments into a "blank slate". An image where another image is imported and super-imposed on top of the starting image.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_core_aspects_of_c2pa">2.3. Core Aspects of C2PA</h3>
<div class="sect3">
<h4 id="_assertion">2.3.1. Assertion</h4>
<div class="paragraph">
<p>A data structure which represents a statement asserted by an <em>actor</em> concerning the <em>asset</em>. This data is a part of the <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim">2.3.2. Claim</h4>
<div class="paragraph">
<p>A digitally signed and tamper-evident data structure that references a set of <em>assertions</em> by one or more <em>actors</em>, concerning an <em>asset</em>, and the information necessary to represent the <em>content binding</em>. If any <em>assertions</em> were redacted, then a declaration to that effect is included. This data is a part of the <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_claim_signature">2.3.3. Claim signature</h4>
<div class="paragraph">
<p>The digital signature on the <em>claim</em> using the private key of an <em>actor</em>. The claim signature is a part of the <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_manifest">2.3.4. Manifest</h4>
<div class="paragraph">
<p>The set of information about the <em>provenance</em> of an <em>asset</em> based on the combination of one or more <em>assertions</em> (including <em>content bindings</em>), a single <em>claim</em>, and a <em>claim signature</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A manifest can reference other manifests.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_origin">2.3.5. Origin</h4>
<div class="paragraph">
<p>The <em>manifest</em> in the <em>provenance data</em> which represents the method or device that initially created the <em>asset</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Details on how one determines which <em>manifest</em> is the <em>origin</em> are left for specification.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_active_manifest">2.3.6. Active Manifest</h4>
<div class="paragraph">
<p>The last manifest in the list of manifests which is the one with the set of <em>content bindings</em> that are able to be validated.</p>
</div>
</div>
<div class="sect3">
<h4 id="_provenance">2.3.7. Provenance</h4>
<div class="paragraph">
<p>The logical concept of understanding the history of an <em>asset</em> and its interaction with <em>actors</em> and other <em>assets</em>, as represented by the <em>provenance data</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_provenance_data">2.3.8. Provenance data</h4>
<div class="paragraph">
<p>The set of <em>manifests</em> for an <em>asset</em> and its ingredients, if any.</p>
</div>
</div>
<div class="sect3">
<h4 id="_content_binding">2.3.9. Content binding</h4>
<div class="paragraph">
<p>Information that associates <em>digital content</em> to a specific <em>manifest</em> associated with a specific <em>asset</em>, either as a <em>hard binding</em> or a <em>soft binding</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hard_binding">2.3.10. Hard binding</h4>
<div class="paragraph">
<p>One or more cryptographic hashes that uniquely identifies either the entire <em>asset</em> or a portion thereof.</p>
</div>
</div>
<div class="sect3">
<h4 id="_soft_binding">2.3.11. Soft binding</h4>
<div class="paragraph">
<p>A content identifier that is either (a) not statistically unique, such as a <em>fingerprint</em>, or (b) embedded as a <em>watermark</em> in the identified content.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_terms">2.4. Additional Terms</h3>
<div class="sect3">
<h4 id="_fingerprint">2.4.1. Fingerprint</h4>
<div class="paragraph">
<p>A set of inherent properties computable from <em>digital content</em> that identifies the content or near duplicates of it.</p>
</div>
<div class="paragraph">
<p><strong>EXAMPLE:</strong> An <em>asset</em> can become separated from its <em>manifest</em> due to removal or corruption of <em>asset</em> metadata. A <em>fingerprint</em> of the <em>digital content</em> of the <em>asset</em> could be used to search a database to recover the <em>asset</em> with an intact <em>manifest</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_watermark">2.4.2. Watermark</h4>
<div class="paragraph">
<p>Information incorporated into <em>digital content</em> (perceptibly or imperceptibly) in a manner that makes the data difficult to remove without impacting the <em>digital content</em> or its <em>asset</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This can be used, for example, to uniquely identify the <em>asset</em> or to store a reference to a <em>manifest</em>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_provenance_datastore">2.4.3. Provenance datastore</h4>
<div class="paragraph">
<p>A repository into which C2PA <em>manifests</em> can be placed, and which can be searched using a <em>content binding</em>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_normative_references">3. Normative References</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_core_formats">3.1. Core Formats</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc8259">JSON</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8949">CBOR</a></p>
</li>
<li>
<p><a href="https://json-schema.org/specification-links.html#2020-12">JSON Schema</a></p>
</li>
<li>
<p><a href="https://www.iso.org/standard/73604.html">JPEG universal metadata box format</a> (JUMBF)</p>
</li>
<li>
<p><a href="https://www.iso.org/standard/74428.html">ISO Base Media File Format</a> (BMFF)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_digital_electronic_signatures">3.2. Digital &amp; Electronic Signatures</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tools.ietf.org/html/rfc5280">X.509 Certificates</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7518">JSON Web Algorithms</a> (JWA)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8152">CBOR Object Signing and Encryption</a> (COSE)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8230">Using RSA Algorithms with COSE Messages</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc6960">Online Certificate Status Protocol</a> (OCSP)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3161">Internet X.509 PKI Time-Stamp Protocol</a></p>
</li>
<li>
<p><a href="https://datatracker.ietf.org/doc/draft-ietf-cose-x509/">CBOR Object Signing and Encryption (COSE): Header parameters for carrying and referencing X.509 certificates</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc3279">Algorithms and Identifiers for the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc5758">Internet X.509 Public Key Infrastructure: Additional Algorithms and Identifiers for DSA and ECDSA</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc8017">PKCS #1: RSA Cryptography Specifications Version 2.2</a></p>
</li>
<li>
<p><a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JSON Advanced Electronic Signatures</a> (JAdES)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_other">3.3. Other</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.adobe.com/products/xmp.html">eXtensible Metadata Platform</a> (XMP)</p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc4122">UUID</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_standard_terms">4. Standard Terms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a>, <a href="https://tools.ietf.org/html/rfc2119">RFC2119</a>, and <a href="https://tools.ietf.org/html/rfc8174">RFC8174</a> when they appear in any casing (upper, lower or mixed).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assertions">5. Assertions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_general">5.1. General</h3>
<div class="paragraph">
<p>It is expected that each of the actors in the system that creates, receives or processes an asset will produce one or more <strong>assertions</strong> about when, where, and how the asset was originated or transformed. An assertion is labelled data, typically (though not required to be) in a CBOR-based structure which represents a declaration made by an actor about an asset. Some of these actors will be human and add human-generated information (e.g., copyright) while other actors are machines (software/hardware) providing the information they generated (e.g., camera type).</p>
</div>
<div class="paragraph">
<p>Some examples of assertions are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Camera information (e.g., maker, lens)</p>
</li>
<li>
<p>Actions performed on the asset (e.g., clipping, color correction)</p>
</li>
<li>
<p>Thumbnail of the asset or its ingredients</p>
</li>
<li>
<p>Content bindings (e.g., cryptographic hashes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Certain assertions may be redacted by subsequent claims (see <a href="#_redaction_of_assertions">Section 5.7, &#8220;Redaction of Assertions&#8221;</a>), but they cannot be modified once made as part of a claim.</p>
</div>
</div>
<div class="sect2">
<h3 id="_labels">5.2. Labels</h3>
<div class="paragraph">
<p>Each assertion has a <strong>label</strong> defined either by the C2PA specifications or an external entity.</p>
</div>
<div class="paragraph">
<p>Labels are string values organized into namespaces using a period (<code>.</code>) as a separator.  The most common labels will be defined by the C2PA and will begin with <code>c2pa.</code>. Entity-specific labels shall begin with the Internet domain name (without the top level domain (TLD), if that TLD is <code>.com</code>) for the entity (e.g., <code>adobe.</code>, <code>bbc.</code>), similar to how Java packages are defined. They are also versioned with a simple incrementing integer scheme (e.g., <code>c2pa.claim.date.v2</code>). If no version is provided, it is considered as <code>v1</code>. The list of publicly known labels can be found in <a href="#_c2pa_standard_assertions">Chapter 17, <em>C2PA Standard Assertions</em></a>.</p>
</div>
<div class="paragraph">
<p>The period-separated components of a label follow the variable naming convention (<code>[a-zA-Z_][a-zA-Z0-9_]*</code>) specified in the POSIX or C locale, with the restriction that the use of a repeated underscore character (<code>__</code>) is reserved for labeling multiple assertions of the same type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_versioning">5.3. Versioning</h3>
<div class="paragraph">
<p>When an assertion’s schema is changed, it should be done in a backwards-compatible manner. This means that new fields may be added and existing ones may be marked as deprecated (ie. can be read, but never written), but existing fields shall not be removed. The label would now consist of an incremented version number, for example moving from <code>c2pa.location.broad</code> to <code>c2pa.location.broad.v2</code>.</p>
</div>
<div class="paragraph">
<p>However, there are situations where a non-backwards compatible change is required. In that case, instead of increasing the label’s version number, the assertion shall be given a new label. For example, <code>c2pa.location.broad</code> to <code>c2pa.location.very-broad</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_instances">5.4. Multiple Instances</h3>
<div class="paragraph">
<p>Multiple assertions of the same type can occur in the same manifest, but since assertions are referenced by claims via their label, the assertion labels must be unique.  This is accomplished by adding a double-underscore and and a monotonically increasing index to the label.  For example, if a manifest contains a single assertion of type <code>schema.org.CreativeWork</code>, then the assertion label will be <code>schema.org.CreativeWork</code>.  If a manifest contains three assertions of this type, the labels will be <code>schema.org.CreativeWork</code>, <code>schema.org.CreativeWork__1</code> and <code>schema.org.CreativeWork__2</code>.</p>
</div>
<div class="paragraph">
<p>When a label includes a version number, that version number is part of the label itself. As such, when there are multiple instances, the instance number continues to follow the label - e.g., <code>c2pa.location.broad.v2__2</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_assertion_store">5.5. Assertion Store</h3>
<div class="paragraph">
<p>The set of assertions referenced by a <a href="#_claims">claim</a> in a manifest are collected together into a logical construct that is referred to as the <strong>assertion store</strong>. When embedded in an asset, the assertions shall be stored as described in <a href="#_use_of_jumbf">Section 10.1, &#8220;Use of JUMBF&#8221;</a>, but when stored externally (e.g., in the cloud) they may be stored in any fashion.</p>
</div>
<div class="paragraph">
<p>For each manifest, there is a single assertion store associated with it. However, as an asset may have multiple manifests associated with it, each one representing a specific series of assertions, there may be multiple assertion stores associated with an asset.</p>
</div>
</div>
<div class="sect2">
<h3 id="_embedded_vs_externally_stored_data">5.6. Embedded vs Externally-Stored Data</h3>
<div class="paragraph">
<p>As mentioned above, the entire assertion store (and all of the assertions that it contains) may be located externally from the asset (e.g., in the cloud). When the assertion store is embedded in an asset, it is still possible for an individual assertion to be located internally or externally. Additionally, just the data for a given assertion may also be located externally via a cloud data assertion (see <a href="#_cloud_data">Section 17.8, &#8220;Cloud Data&#8221;</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_redaction_of_assertions">5.7. Redaction of Assertions</h3>
<div class="paragraph">
<p>Assertions that are present in an asset-embedded assertion store (regardless of whether their data is embedded or not) may be removed from future versions of the asset. This process is called redaction.</p>
</div>
<div class="paragraph">
<p>When an assertion is redacted, then either the redacted assertion is removed from the assertion store, or the labeled assertion container is retained but the assertion data itself is replaced with zeros.</p>
</div>
<div class="paragraph">
<p>Neither authoring tools nor claims generators shall redact assertions with a label of <code>c2pa.action</code> as this assertion type represents essential information in understanding the history of an asset. Additionally, such tools should take care not to redact assertions when they believe a human actor has a clear intention about its continued importance and propagation (e.g., <code>schema.org.CreativeWork</code> assertions where the <code>copyright</code> fields have been filled out).</p>
</div>
<div class="paragraph">
<p>As part of the process of redacting an assertion, a record that something was removed is added to the <a href="#_claims">claim</a>. Because each assertion’s <a href="#_uri_references">URI reference</a> includes the assertion label, it is also known what type of information (e.g., thumbnail, location, etc.) was removed. This enables both humans and machines to apply rules to determine if the removal was acceptable.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unique_identifiers">6. Unique Identifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every asset that is referenced from an assertion or claim shall be referenced via one or more unique identifiers. These identifiers are used in various parts of a C2PA-enabled workflow, such as when identifying it as an <a href="#_ingredients">ingredient</a> in a derived or composed asset.</p>
</div>
<div class="sect2">
<h3 id="_using_xmp">6.1. Using XMP</h3>
<div class="paragraph">
<p>When an asset contains embedded XMP, that XMP shall include (at least) values for <code>xmpMM:DocumentID</code> and <code>xmpMM:InstanceID</code> as defined in <a href="https://wwwimages2.adobe.com/content/dam/acom/en/devnet/xmp/pdfs/XMP%20SDK%20Release%20cc-2014-12/XMPSpecificationPart2.pdf">XMP Specification Part 2, 2.2</a>. If an asset does not contain XMP at the time a claim is made, and the type of the asset supports it, an embedded XMP packet may be created as part of the process, and the identifiers shall be added to it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">NOTE 1</div>
Some asset types are not suited for embedded XMP (e.g., text). It is possible to create XMP as a sidecar.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">NOTE 2</div>
The <a href="https://github.com/adobe/XMP-Toolkit-SDK/">Adobe XMP Toolkit SDK</a> can be used to create and modify XMP in <a href="https://github.com/adobe/XMP-Toolkit-SDK/tree/master/XMPFiles/source/FileHandlers">various asset types</a>. Alternatively, since XMP is serialized as XML+RDF, any standard XML library can be used for the purpose of working with XMP (though asset specific processing would be left up to the processor).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_other_identifiers">6.2. Other Identifiers</h3>
<div class="paragraph">
<p>Instead of using XMP, a unique identifier for an asset could be that provided by various standards including <a href="https://www.eidr.org/">EIDR</a> and <a href="https://www.doi.org/">DOI</a> by means of a URL of the identifier (not the URL of the asset).</p>
</div>
<div class="paragraph">
<p>Another standard unique identifier for an asset could be the cryptographic hash of the asset. When this method is used, the hash shall be represented using a standard <a href="https://tools.ietf.org/html/rfc4122">RFC 4122 UUID</a> following the recommendations at <a href="https://datatracker.ietf.org/doc/html/draft-thiemann-hash-urn-01" class="bare">https://datatracker.ietf.org/doc/html/draft-thiemann-hash-urn-01</a> .</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
Other methods may be defined here as they are developed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_uri_references">6.3. URI References</h3>
<div class="paragraph">
<p>Assertions and claims, whether they are stored internally to the asset (ie. embedded) or stored externally to the asset (e.g., in the cloud), shall be referenced via JUMBF URI references as defined in <a href="https://www.iso.org/standard/73604.html">ISO 19566-5, C.2</a>. This URI shall be used as part of a <code>hashed_uri</code> data structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/hashed-uri/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The data structure used to store a reference to a URL and its hash"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"definitions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"JUMBF_URI"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#JUMBF_URI"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^self#jumbf=[</span><span class="se">\\</span><span class="s2">w</span><span class="se">\\</span><span class="s2">d][</span><span class="se">\\</span><span class="s2">w</span><span class="se">\\</span><span class="s2">d</span><span class="se">\\</span><span class="s2">.</span><span class="se">\/</span><span class="s2">:-]+[</span><span class="se">\\</span><span class="s2">w</span><span class="se">\\</span><span class="s2">d]$"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JUMBF URI reference"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.claim.date.v1"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hoOspQQ1lFTy/4Tp8Epx670E5QW5NwkNR+2b30KFXug="</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"hash"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/JUMBF_URI"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JUMBF URI reference"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A string identifying the cryptographic hash algorithm used to compute all hashes in this claim, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken from an enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CBOR byte string containing the hash value"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This syntax enables these various objects to live either embedded or stored in the cloud while also providing the important hash value for validation purposes.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The hash is performed over the canonical serialization of the assertion data, omitting the surrounding container.  For example, if the assertion type is <code>c2pa.actions.v1</code>, then the hash is calculated over the canonical serialization serialization of <code>actions-map</code>.</p>
</div>
<div class="paragraph">
<p>If a URI reference is an external URL (as defined in <a href="https://www.iso.org/standard/73604.html">ISO 19566-5, C.2</a>), then the domain of that URL shall be the same domain/organization associated with the signing certificate used on the <a href="#_signing_a_claim">claim signature</a>. Also, for URI references to assertions stored externally to the asset, the label of the assertion shall be included in the query parameter of the URL, such as <code><a href="http://c2pa.adobe.com/assertions/123456?cai=c2pa.location.broad" class="bare">http://c2pa.adobe.com/assertions/123456?cai=c2pa.location.broad</a></code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_w3c_verifiable_credentials">7. W3C Verifiable Credentials</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_general_2">7.1. General</h3>
<div class="paragraph">
<p>In some use cases, the actors in the system may wish to provide their own credentials, as they exist at that moment in time, to the claim generator to have them associated with one or more assertions. These actors may be individuals, groups or organizations.</p>
</div>
<div class="paragraph">
<p>In the C2PA ecosystem, these credentials provide additional trust signals that can be used by the manifest consumer. For example, they could represent a person or organization&#8217;s membership in a professional organization, diplomas and certificates issued by educational institutions, or other qualifications relevant to the actor&#8217;s involvement in the asset. Although these credentials can include their own proofs of authenticity, C2PA only establishes the signer&#8217;s assertion that they are acting as a holder of the credential on behalf of its issuer. Any further validation of the credential is out of scope and has no bearing on the <a href="#_trust_model">C2PA Trust Model</a>.</p>
</div>
<div class="paragraph">
<p>Such credentials shall be compliant with the <a href="https://www.w3.org/TR/vc-data-model/">W3C Verifiable Credentials Data Model</a> using the <a href="https://www.w3.org/TR/vc-data-model/#json-ld">JSON-LD serialisation</a> described there.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>JSON-LD serialization is mandated as it is the most commonly used of the three syntaxes presented in section 6 of the W3C Verifiable Credentials specification. It is also the one that aligns best with its extensibility model, which could be useful to some implementors.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An example of a compliant credential for an individual might be one issued by the National Press Photographers Association (NPPA), which links an identifier for a person to their name ("Bob Ross") and a statement about their membership of the NPPA. It might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@context"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"https://www.w3.org/2018/credentials/v1"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"http://schema.org"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"VerifiableCredential"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"NPPACredential"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"issuer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://nppa.org/"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"credentialSubject"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"did:nppa:eb1bb9934d9896a374c384521410c7f14"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bob Ross"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"memberOf"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://nppa.org/"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"proof"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RsaSignature2018"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"created"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-06-18T21:19:10Z"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"proofPurpose"</span><span class="p">:</span><span class="w"> </span><span class="s2">"assertionMethod"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"verificationMethod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"did:nppa:eb1bb9934d9896a374c384521410c7f14#_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"jws"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJQUzI1NiIsImI2NCI6ZmFsc2UsImNyaXQiOlsiYjY0Il19
      DJBMvvFAIC00nSGB6Tn0XKbbF9XrsaJZREWvR2aONYTQQxnyXirtXnlewJMB
      Bn2h9hfcGZrvnC1b6PgWmukzFJ1IiH1dWgnDIS81BH-IxXnPkbuYDeySorc4
      QU9MJxdVkY5EL4HYbcIfwKj6X4LBQ2_ZHZIu1jdqLcRZqHcsDF5KKylKc1TH
      n5VRWy5WhYg_gBnyWny8E6Qkrze53MR7OuAmmNJ1m1nN8SxDrG6a08L78J0-
      Fbas5OjAQz3c17GY8mVuDPOBIOVjMEghBlgl3nOi1ysxbRGhHLEK4s0KKbeR
      ogZdgt1DkQxDFxxn41QWDw_mmMCjs9qxg0zcZzqEJw"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A W3C Verifiable Credential used with C2PA shall contain only a single <code>credentialSubject</code> and that <code>credentialSubject</code> shall have an <code>id</code> value.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Although the example above and many examples in the W3C Verifiable Credentials data model specification use Decentralized Identifiers (DIDs) as the value of the <code>id</code> field, DIDs are not necessary for W3C Verifiable Credentials to be useful. Specifically, W3C Verifiable Credentials do not depend on DIDs and DIDs do not depend on W3C Verifiable Credentials. DID-based URLs are just one way to express identifiers associated with subjects, issuers, holders, credential status lists, cryptographic keys, and other machine-readable information associated with a W3C Verifiable Credential.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_vcstore">7.2. VCStore</h3>
<div class="paragraph">
<p>The set of credentials in a manifest are collected together into a logical construct that is referred to as the <strong>credential store</strong> or <strong>VCStore</strong> (for short) and it shall be stored as described in <a href="#_use_of_jumbf">Section 10.1, &#8220;Use of JUMBF&#8221;</a>.  Unlike the assertion store, the VCStore shall always be included in the JUMBF - it shall not be stored separately.</p>
</div>
<div class="paragraph">
<p>For each manifest, there is a VCStore associated with it. However, as an asset may have multiple manifests associated with it, there may be multiple VCStores associated with an asset.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_credentials">7.3. Using Credentials</h3>
<div class="paragraph">
<p>The <a href="#_creative_work">Creative Work</a> assertion may contain references to Persons or Organisations which are responsible for various roles and responsibilities to the Work. These references may contain W3C Verifiable Credentials via the <code>credential</code> field whose value is the <a href="#_uri_references">hashed JUMBF URI</a> to the specific credential in the VCStore. When present in the Person or Organization object, its <code>id</code> field shall match the <code>id</code> field present in the credentialSubject field of the VCs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"@context"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://schema.org/"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CreativeWork"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"copyrightHolder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BBC"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"legalName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"British Broadcasting Corporation"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.bbc.co.uk/"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"credential"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.credentials/https://www.bbc.co.uk/"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"copyrightYear"</span><span class="p">:</span><span class="w"> </span><span class="mi">2021</span><span class="p">,</span><span class="w">
  </span><span class="nl">"copyrightNotice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Copyright © 2021 BBC."</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_credential_verification">7.4. Credential Verification</h3>
<div class="paragraph">
<p>In most W3C Verifiable Credential workflows, the information about the subject (e.g., the cryptographic keys) is fetched on demand at the time of validation. While that is an acceptable model, it does open up a possible attack vector by providing an attacker with an externally-visible signal about what the validator is validating. Therefore, C2PA also supports having the information captured and embedded at the time of signature. This not only prevents leakage, but also makes it very clear what data the signer is asserting about the credential&#8217;s subject.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Open Issue #83</div>
<div class="paragraph">
<p>The details of how this information will be stored in the C2PA manifest are still TBD.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_binding_to_content">8. Binding to Content</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2">8.1. Overview</h3>
<div class="paragraph">
<p>A key aspect to the C2PA manifest is the presence of one or more data structures that can uniquely identify portions of the asset. There are two types of bindings that are supported by C2PA - hard bindings and soft bindings. A hard binding (also known as a cryptographic binding) enables the verifier to ensure that (a) this manifest belong with this asset and (b) that the asset has not been modified, by determining values that can match only this asset and no other, not even other assets derived from it or renditions produced from it.  A soft binding is computed from the digital content of an asset, rather than its raw bits.  A soft binding is useful for identifying derived assets and asset renditions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_hard_bindings">8.2. Hard Bindings</h3>
<div class="sect3">
<h4 id="_hashing_using_byte_ranges">8.2.1. Hashing using byte ranges</h4>
<div class="paragraph">
<p>The simplest type of hard binding that can be used to detect tampering is a cryptographic hashing algorithm, as described in <a href="#_hashing">Section 12.1, &#8220;Hashing&#8221;</a>, over some or all of the bytes of an asset. This approach can be used on any type of asset.</p>
</div>
<div class="paragraph">
<p>When using this form of hard binding, one or more <a href="#_data_hash">data hash assertions</a> is used to define the range of bytes that are hashed (and those that are not). Because each data hash assertion defines a byte range and optional URL, it is flexible enough to be usable whether the asset is a single binary or represented in multiple chunks or portions, local or remote.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hashing_a_bmff_formatted_asset">8.2.2. Hashing a BMFF-formatted asset</h4>
<div class="paragraph">
<p>If the asset is based on <a href="https://www.iso.org/standard/74428.html">ISO BMFF</a> then a hard binding optimized for the box-based format (called <a href="#_BMFF-based_hash">BMFF-based hash assertions</a>) may be used instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="_metadata_bindings">8.2.3. Metadata Bindings</h4>
<div class="paragraph">
<p>In those workflows which embed XMP or other forms of metadata into the asset, it is important to ensure that the asset&#8217;s metadata is not excluded by the <a href="#_data_hash">data hash assertion</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_soft_bindings">8.3. Soft Bindings</h3>
<div class="paragraph">
<p>Soft bindings are described using <a href="#_soft_binding">soft binding assertions</a> such as via a perceptual hash computed from the digital content or a watermark embedded within the digital content. These soft bindings enable digital content to be matched even if the underlying bits differ, for example due to an asset rendition in a different resolution or encoding format. Additionally, should a C2PA manifest be removed from an asset, but a copy of that manifest remains in a provenance store elsewhere, the manifest and asset may be matched using available soft bindings.</p>
</div>
<div class="paragraph">
<p>Because they serve a different purpose, a soft binding shall not be used as a <em>hard binding</em>.</p>
</div>
<div class="paragraph">
<p>All soft bindings shall be generated using one of the algorithms listed as supported by the C2PA soft binding algorithm registry. This registry will define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of algorithms that are allowed for generating soft bindings of new content as well as required for validating or locating existing content (the "allowed" list), and</p>
</li>
<li>
<p>A list of algorithms that are required to be supported for validating or locating existing content but are not allowed for generating soft bindings of new content (the "deprecated" list).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This list will establish the allowed algorithms for creating a soft binding from the digital content of an asset (or part thereof) and a string algorithm identifier to be used as the algorithm identifier in the corresponding field.</p>
</div>
<div class="paragraph">
<p>Different versions of an algorithm must be defined using different string algorithm identifiers.</p>
</div>
<div class="paragraph">
<p>An algorithm when described in the registry must define the content types over which it is applicable.</p>
</div>
<div class="paragraph">
<p>An algorithm when described in the registry must reference technical documentation sufficient for the soft binding algorithm to be implemented.</p>
</div>
<div class="paragraph">
<p>An algorithm when described in the registry must be defined along with the names and values of all parameters affecting the operation of that algorithm and describe the manner in which those parameters must be encoded within the <code>alg-params</code> field of the <a href="#_soft_binding">soft binding assertion</a>.  An algorithm that is instantiated over a different parameter set will be considered a different algorithm.</p>
</div>
<div class="paragraph">
<p>An algorithm when described in the registry may also define an encoding scheme for specifying the portion of digital content over which a soft binding is computed (namely, the <code>extent</code> field of the <code>SOFTBINDING_SCOPE</code> structure within the <a href="#_soft_binding">soft binding assertion</a>.  An algorithm that encodes the <code>extent</code> differently will be considered a different algorithm.</p>
</div>
<div class="paragraph">
<p>It is recommended that the string identifiers for soft binding algorithms conform to how they are referred to in common practice.</p>
</div>
<div class="paragraph">
<p>There are no soft binding algorithms recommended in this version of the specification.  If the C2PA&#8217;s soft binding hash algorithm registry has not yet been established, then the registry (the "bootstrap registry") shall contain an empty deprecated list and an empty allowed list.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_claims">9. Claims</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3">9.1. Overview</h3>
<div class="paragraph">
<p>A <strong>claim</strong> gathers together all the assertions about an asset from an actor at a given time including the set of assertions for <a href="#_binding_to_content">binding to the content</a>. The claim is then cryptographically hashed and signed as described in <a href="#_signing_a_claim">Section 9.3.2.4, &#8220;Signing a Claim&#8221;</a>. A claim has all the same properties as an assertion including being assigned a label (<code>c2pa.claim</code>). It can also either be embedded into the asset or stored remotely (e.g., in the cloud).</p>
</div>
</div>
<div class="sect2">
<h3 id="_syntax">9.2. Syntax</h3>
<div class="paragraph">
<p>A claim is a CBOR-based data structure whose <a href="https://json-schema.org/">JSON Schema</a> definition follows, including an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/claim/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JSON schema for a claim object in C2PA"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"definitions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"JUMBF_URI"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#JUMBF_URI"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^self#jumbf=[</span><span class="se">\\</span><span class="s2">w</span><span class="se">\\</span><span class="s2">d][</span><span class="se">\\</span><span class="s2">w</span><span class="se">\\</span><span class="s2">d</span><span class="se">\\</span><span class="s2">.</span><span class="se">\/</span><span class="s2">]+[</span><span class="se">\\</span><span class="s2">w</span><span class="se">\\</span><span class="s2">d]$"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JUMBF URI reference"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"dc:title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image 1.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"dc:format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"stRef:InstanceID"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid:7b57930e-2f23-47fc-affe-0400d70b738d"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"claim_generator"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe's Photo Editor/2.0 (Windows 10)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"signature"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.signature"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"alg"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"assertions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                  </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.data.hash.v1"</span><span class="p">,</span><span class="w">
                  </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.claim.thumbnail.jpeg"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DjZifCgG2iKxcYeChKTOcWlJ9I/UC9/c5XFiJREqJFpwA="</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.assertions/c2pa.claim.ingredient"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m7ZifCgG2iKxcYeChKTOcWlJ9I/UC9/c5XFiJREqJFpwA="</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"redacted_assertions"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"self#jumbf=c2pa/urn:uuid:5E7B01FC-4932-4BAB-AB32-D4F12A8AA322/c2pa.assertions/c2pa.location.precise"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"dc:format"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"stRef:InstanceID"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"claim_generator"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"signature"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"assertions"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"dc:title"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name of the ingredient"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"dc:format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"media type of the ingredient"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"stRef:InstanceID"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value of the ingredient's `xmpMM:InstanceID`"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"claim_generator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A User-Agent string formatted as per http://tools.ietf.org/html/rfc7231#section-5.5.3, for including the name and version of the claims generator that created the claim."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"signature"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/JUMBF_URI"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JUMBF URI reference to the signature of this claim"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"assertions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"List of hashed URI references to the assertions of this claim"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"additionalItems"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/hashed-uri"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"redacted_assertions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"List of JUMBF URI references to previous assertions"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"additionalItems"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#JUMBF_URI"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A string identifying the cryptographic hash algorithm used to compute all data hash assertions listed in this claim unless otherwise overridden, taken from the C2PA data hash algorithm identifier registry. This provides the value for the 'alg' field in data-hash and hashed-uri structures contained in this claim."</span><span class="w">
        </span><span class="p">},</span><span class="w">  
        </span><span class="nl">"alg_soft"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A string identifying the algorithm used to compute all soft binding assertions listed in this claim unless otherwise overridden, taken from the C2PA soft binding algorithm identifier registry."</span><span class="w">
        </span><span class="p">}</span><span class="w">  
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The type/format of the ingredient shall be present in <code>dc:format</code>. If present, the value of <code>dc:title</code> shall be a human-readable name for the asset.</p>
</div>
<div class="paragraph">
<p>If the asset contains XMP, then the asset&#8217;s <code>xmpMM:InstanceID</code> should be used as the <code>stRef:InstanceID</code>. When no XMP is available, then some other <a href="#_unique_identifiers">unique identifier</a> for the asset shall be used as the value for <code>stRef:InstanceID</code>.</p>
</div>
<div class="paragraph">
<p>The value of <code>claim_generator</code> is a human-readable string that will let a user know what software/hardware/system produced this Claim.  This string shall conform to the User-Agent string format specified in section 5.5.3 of <a href="http://tools.ietf.org/html/rfc7231#section-5.5.3"> HTTP/1.1 Semantics and Content</a>.</p>
</div>
<div class="paragraph">
<p>The <code>signature</code>, <code>assertions</code>, and <code>redacted_assertions</code> fields contain <a href="#_uri_references">URI references</a> to their respective types - <a href="#_signing_a_claim">claim signature</a>, <a href="#_assertions">assertions</a>, and <a href="#_redaction_of_assertions">redacted assertions</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_creating_a_claim">9.3. Creating a Claim</h3>
<div class="sect3">
<h4 id="_creating_assertions">9.3.1. Creating Assertions</h4>
<div class="paragraph">
<p>Before the claim can be finalized, all <a href="#_assertions">assertions</a> must be created and stored in a newly created <a href="#_c2pa_box_details">C2PA Assertion Store</a>. This includes all of the content binding assertions that need to be present to ensure the asset is tamper-evident. A claim shall include one or more content binding assertions in its list of assertions and the asset data (e.g., pixels in an image) shall not be excluded by any of the content binding assertions. It may still not be possible to know all of the binding information at the time of claim creation, in which case use the <a href="#_multiple_step_processing">multiple step processing method</a> to setup and then later fill-in the information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_preparing_the_claim">9.3.2. Preparing the Claim</h4>
<div class="sect4">
<h5 id="_adding_assertions_and_redactions">9.3.2.1. Adding Assertions and Redactions</h5>
<div class="paragraph">
<p>The claim shall contain the <code>assertions</code> field and its value is a list of all of the URI references for all assertions that were added to the assertion store that are being "claimed" by this claim. At least one of the assertions shall be either a <a href="#_data_hash">data hash assertion</a> or a <a href="#_BMFF-based_hash">BMFF-based hash assertion</a>.</p>
</div>
<div class="paragraph">
<p>If any assertions in ingredient claims are being redacted, their URI references shall be added to list which is the value of the <code>redacted_assertions</code> field.</p>
</div>
</div>
<div class="sect4">
<h5 id="_adding_ingredients">9.3.2.2. Adding Ingredients</h5>
<div class="paragraph">
<p>In many authoring scenarios, an actor does not create an entirely new asset but instead brings in other existing assets on which to create their work - either as a derived asset, a composed asset or an asset rendition. These existing assets are called ingredients and their use is documented in the provenance data through the use of an <a href="#_Ingredients">ingredient assertion</a>. When an ingredient contains a C2PA manifest, that manifest must be inserted into this asset to ensure that the provenance data is kept intact. Such ingredient manifests are added to the JUMBF as described in <a href="#_c2pa_box_details">Section 10.1.1, &#8220;C2PA Box details&#8221;</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_connecting_the_signature">9.3.2.3. Connecting the Signature</h5>
<div class="paragraph">
<p>The signature cannot be part of the signed payload, but since its label is pre-defined, then the full URI reference is also known. As such, we can include that in the claim by setting the value of the <code>signature</code> field of the claim to that URI reference.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This provides the explicit binding of the claim to its signature.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_signing_a_claim">9.3.2.4. Signing a Claim</h5>
<div class="paragraph">
<p>Producing the signature is specified in <a href="#_digital_signatures">Section 12.2, &#8220;Digital Signatures&#8221;</a>. The CBOR claim document as it appears in the C2PA Claim box is the payload, and the "detached mode" is used to produce a <code>COSE_Sign1</code> structure. The resulting <code>COSE_Sign1</code> structure is written into the C2PA Claim Signature box.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>A more typical structure would be to expand the claim schema to have a "to-be-signed" or "payload" member which contains what is currently the entire claim schema, and then add an additional field to contain the detached COSE signature. This is what X.509 does, and what COSE does in the default (non-detached) case where the payload is included encoded as a field of the <code>COSE_Sign1</code> structure. As there is no expectation CBOR is directly human-readable, the recommendation would be to use the <code>COSE_Sign1</code> structure with the payload included, as then there will be no need for C2PA to specify its own container format for the signature.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_timestamps">9.3.2.5. TimeStamps</h5>
<div class="paragraph">
<p>If possible, the signer should use a Trust Service Provider (specifically a Trusted TimeStamp Provider) to generate a trusted token (time-mark or time-stamp token) proving that the signature itself actually existed at a certain date and time and incorporate that into the signature. All timestamps shall be done as described in <a href="https://tools.ietf.org/html/rfc3161">RFC3161</a> as an unprotected header parameter named <code>sigTst</code> in the <code>COSE_Sign1</code> structure following the definition in <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES section 5.3.4</a>.</p>
</div>
<div class="paragraph">
<p>The <code>MessageImprint</code> for the <code>TimeStampReq</code> structure shall be computed by creating the <code>ToBeSigned</code> value in section 4.4 of RFC 8152, using "CounterSignature" as the context string for the <code>Sig_structure</code>. The <code>payload</code> for the <code>Sig_structure</code> is as described in <a href="#_signing_a_claim">Section 9.3.2.4, &#8220;Signing a Claim&#8221;</a>. The <code>ToBeSigned</code> value is then hashed using an approved hash algorithm that the time stamping authority (TSA) supports, and that hash algorithm and value are placed in the <code>MessageImprint</code>. The <code>certReq</code> boolean of the <code>TimeStampReq</code> structure must be asserted in the request to the TSA, to ensure its certificate is provided in the response. The serialized content of the <code>TimeStampToken</code> received in reply is then stored as the <code>sigTst</code> header&#8217;s value.</p>
</div>
<div class="paragraph">
<p>The serialized content of the <code>TimeStampToken</code> received in reply shall then be stored as the <code>val</code> property of a <code>tstToken</code> element of the <code>tstTokens</code> array property of the <code>tstTokens</code> element of the <code>sigTst</code> header as defined by <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES section 5.3.4</a> and <a href="https://forge.etsi.org/rep/esi/x19_182_JAdES/raw/v1.1.1/19182-jsonSchema.json">its JSON schema</a>, except with the modification that the content of <code>val</code> is a byte string containing the content of the <code>TimeStampToken</code>, and not a Base64-encoded version of the same. The <code>tstTokens</code> array shall contain at least one element.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Recall that an "unprotected" header only means it is not included in the protected payload of the claim. A timestamp, like all countersignatures, is itself signed (and so brings its own integrity protection) and has to be produced after the claim is signed, and so cannot be a part of the claim&#8217;s protected payload.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_credential_revocation_information">9.3.2.6. Credential Revocation Information</h5>
<div class="paragraph">
<p>If the signer&#8217;s credential type supports querying online credential status, and the credential contains a pointer to a service to provide timestamped credential status information, the signer should query the service, capture the response, and store it in the manner described for the signer&#8217;s credential type in the <a href="#_trust_model">Trust Model</a>. If credential revocation information is attached in this manner, a trusted timestamp must also be obtained after signing, as described in <a href="#_timestamps">Section 9.3.2.5, &#8220;TimeStamps&#8221;</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_referencing_the_active_manifest">9.3.3. Referencing the Active Manifest</h4>
<div class="paragraph">
<p>In order to ensure that a validator can quickly determine the presence of a C2PA manifest, it may be useful to embed information in the asset that is easily accessed in a non-format specific manner.</p>
</div>
<div class="paragraph">
<p>When the asset has embedded XMP, the method used shall be the existence of a <a href="https://www.dublincore.org/specifications/dublin-core/dcmi-terms/#http://purl.org/dc/terms/provenance"><strong>dcterms:provenance</strong></a> key in the XMP with a value that is the URI reference to the active C2PA Manifest. It would look something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;dcterms:provenance&gt;</span>self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4<span class="nt">&lt;/dcterms:provenance&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>Other non-XMP-based methods will be defined here as they are developed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_examples">9.3.4. Examples</h4>
<div class="sect4">
<h5 id="_single_claim">9.3.4.1. Single Claim</h5>
<div class="paragraph">
<p>Here is a visual representation of an image containing a single claim with multiple assertions that have been embedded inside it.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Single_Claim.svg" alt="A single claim with assertions" width="720" height="432">
</div>
<div class="title">Figure 3. A single claim with assertions</div>
</div>
</div>
<div class="sect4">
<h5 id="_multiple_claims">9.3.4.2. Multiple Claims</h5>
<div class="paragraph">
<p>In this example of creating a second claim for the <a href="#_single_claim">previous example</a>, one of the original assertions has been redacted from the previous claim. The visual representation for this scenario would look like:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Multiple_Claims.svg" alt="Redacting assertions in a secondary claim" width="720" height="432">
</div>
<div class="title">Figure 4. Redacting assertions in a secondary claim</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_multiple_step_processing">9.4. Multiple Step Processing</h3>
<div class="paragraph">
<p>There are situations where it is technically necessary to create &amp; embed the manifest into an asset before the actual data of the asset has been fully created. For example, in <a href="https://en.wikipedia.org/wiki/JPEG">JPEG-1</a> files, the entire C2PA Manifest Store must appear in the file before the image data - but if the manifest is to include cryptographic hashes of the image data, in the form of data hash assertions, how to achieve this?</p>
</div>
<div class="paragraph">
<p>To accomplish this, a multiple step approach is taken, similar to how signatures in PDF are done.</p>
</div>
<div class="sect3">
<h4 id="_prepare_the_xmp">9.4.1. Prepare the XMP</h4>
<div class="paragraph">
<p>For those C2PA-enabled assets that contain embedded XMP, start by creating the XMP data stream including adding the <a href="#_referencing_the_active_manifest">active manifest reference</a> and then serialize it into the asset in the standard location reserved for it in the format of the asset.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
While it is possible to add the XMP data to the list of exclusions in a data hash assertion, doing so is not recommended as it would remove tamper detection of that metadata.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_create_content_bindings">9.4.2. Create content bindings</h4>
<div class="paragraph">
<p>As mentioned in <a href="#_creating_assertions">Section 9.3.1, &#8220;Creating Assertions&#8221;</a>, a claim shall include one or more content binding assertions in its list of assertions.</p>
</div>
<div class="paragraph">
<p>In many cases, such as with JPEG-1, it is not possible to hash the asset in its entirety because the manifest will be embedded in the middle of the file, so the size or location manifest data will not be known at the time the asset hash is calculated.  This circular dependency is avoided by allowing exclusion ranges to be specified during hashing.  When exclusion ranges are specified, a single hash is performed, but only over the asset ranges that are not in any of the exclusions.</p>
</div>
<div class="paragraph">
<p>For example, if a manifest is embedded in the center of a JPEG-1 file in an APP11 segment, then the claim creator can exclude the APP11 segment(s) from the hash calculation.</p>
</div>
<div class="paragraph">
<p>In order to prevent insertion attacks, it is desirable to have only a single exclusion range when possible. When the size or location (or both) of the manifest in the asset is not known, then the <code>start</code> and <code>length</code> values in the data hash assertion shall both be zero and the size of the <code>pad</code> value should be large enough to accommodate writing in the values in the second pass.  At least 16 bytes is recommended.</p>
</div>
<div class="paragraph">
<p>Create the data hash assertion and add it to the assertion store.</p>
</div>
</div>
<div class="sect3">
<h4 id="_create_a_temporary_claim_signature">9.4.3. Create a temporary Claim &amp; Signature</h4>
<div class="paragraph">
<p>Add the newly created data hash assertion reference to the claim&#8217;s assertion list providing a temporary hash value, such as empty spaces.</p>
</div>
<div class="paragraph">
<p>At this point, the temporary claim is complete and can be added to the C2PA Manifest being created.</p>
</div>
<div class="paragraph">
<p>Since the claim is only temporary at this time, it is not possible to sign it, so an empty Claim Signature box should also be written that is large enough to include the final data (once produced).  It is recommended to use <code>0</code> bytes to fill the signature.</p>
</div>
</div>
<div class="sect3">
<h4 id="_complete_the_c2pa_manifest">9.4.4. Complete the C2PA Manifest</h4>
<div class="paragraph">
<p>At this point all of the boxes that comprise the entire C2PA Manifest for the asset are completed and can be (if not already) constructed into its final form. The asset&#8217;s C2PA Manifest, along with the manifests of any ingredients, are combined together to form the complete C2PA Manifest Store. The C2PA Manifest Store can then be embedded into the asset as discussed in <a href="#_embedding_manifests_into_bmff_based_assets">Section 10.2.2, &#8220;Embedding manifests into BMFF-based assets&#8221;</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_going_back_and_filling_in">9.4.5. Going back and filling in</h4>
<div class="paragraph">
<p>Now that the C2PA Manifest Store has been embedded into the asset, the starting offset and the length of the active manifest can be updated in its data hash assertion.  It is necessary that when doing so, you don&#8217;t change the size of the assertion&#8217;s box, only its data.  This is done by adjusting the value of the <code>pad</code> field to be the necessary length to "fill up" the remaining bytes.</p>
</div>
<div class="paragraph">
<p>Once the data hash assertion has been updated, it can be hashed and the hash written over the empty spaces that were used previously to hold the location.</p>
</div>
<div class="paragraph">
<p>The claim is now complete, and it can be hashed and signed as described in <a href="#_signing_a_claim">Section 9.3.2.4, &#8220;Signing a Claim&#8221;</a>, with the resultant signature filling the pre-allocated space. The extra <code>0</code> bytes can either be left alone or a new <code>free</code> JUMBF box can be added to mark the space as such.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_manifests">10. Manifests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_use_of_jumbf">10.1. Use of JUMBF</h3>
<div class="paragraph">
<p>In order to support many of the requirements of C2PA, C2PA Manifests needed to be stored (serialized) into a structured binary data store that enabled some specific functionality including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ability to store multiple manifests (e.g., parents and ingredients) in a single container</p>
</li>
<li>
<p>Ability to refer to individual elements (both within and across manifests) via URIs</p>
</li>
<li>
<p>Ability to clearly identify the parts of an element to be hashed</p>
</li>
<li>
<p>Ability to store pre-defined data types used by C2PA (e.g., JSON and CBOR)</p>
</li>
<li>
<p>Ability to store arbitrary data formats (e.g., XML, JPEG, etc.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to supporting all of the requirements above, our chosen container format - <a href="https://www.iso.org/standard/73604.html">JUMBF, ISO 19566-5</a> - is also natively supported by the JPEG family of formats and is compatible with the box-based model (i.e. <a href="https://www.iso.org/standard/68960.html">ISOBMFF, ISO 14496-12</a>) used by many common image and video file formats. Using JUMBF enables all the same benefits (and a few extras, such as <a href="#_uri_references">URI References</a>) while being able to work with classic image formats, such as JPEG/JFIF and PNG as well as 3D and document (e.g., PDF) formats.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Since most of the standard assertions, as well the claim signature, are serialized as CBOR, using CBOR for the entire manifest was considered but not chosen because CBOR is not a container format. It could be used as one through having to re-define how CBOR would be used to provide the features natively supported by JUMBF.</p>
</div>
<div class="paragraph">
<p>For example, to store a "blob of JSON" inside of CBOR, and know that it is JSON (and not some other format) would require designing a data structure for storing such things. Then the parent structure would need to be defined as to how to carry that structure. This same concept would also have to be done for each of the native features of JUMBF.</p>
</div>
<div class="paragraph">
<p>While it would certainly be possible to re-implement all of the required functionality entirely in CBOR, it would be a lot of work and would not fully remove the need for a JUMBF/BMFF parser in all implementations.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_c2pa_box_details">10.1.1. C2PA Box details</h4>
<div class="paragraph">
<p>When C2PA data is serialized into a JUMBF-compatible structure, all of its data is referred to as the C2PA Manifest Store. An example C2PA Manifest Store, with a single manifest, might look like this:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/JUMBF-Single.svg" alt="C2PA Manifest Store" width="301">
</div>
<div class="title">Figure 5. C2PA Manifest Store</div>
</div>
<div class="paragraph">
<p>The C2PA Manifest Store is a JUMBF superbox composed of a series of other JUMBF boxes and superboxes, each identified by their own UUID and label in their JUMBF Description box. The C2PA Manifest Store shall have a label of <code>c2pa.v1</code>, a UUID of <code>0x6332706100110010800000AA00389B71</code> (<code>c2pa</code>) and shall contain one or more C2PA Manifest superboxes.</p>
</div>
<div class="paragraph">
<p>Each C2PA Manifest superbox shall contain the data created at the time a claim is issued including the C2PA Assertion Store, a C2PA Claim, and a C2PA Claim Signature. It may also contain a <a href="#_vcstore">C2PA Credential Store</a>. The UUID for each C2PA Manifest shall be  <code>0x63326D6100110010800000AA00389B71</code> (<code>c2ma</code>), but in order to enable uniquely identifying each manifest, they shall be labelled with a <a href="https://tools.ietf.org/html/rfc4122">RFC 4122, UUID</a> optionally proceeded by an identifier of the claim generator and a <code>:</code>. An example label for the fictitious ACME claim generator might look like <code>acme:urn:uuid:F9168C5E-CEB2-4FAA-B6BF-329BF39FA1E4</code>.</p>
</div>
<div class="paragraph">
<p>The C2PA <a href="#_assertion_store">Assertion Store</a> is a superbox that shall have a label of <code>c2pa.assertions</code> and a UUID of <code>0x6332617300110010800000AA00389B71</code> (<code>c2as</code>). It shall contain one or more JUMBF Content Type boxes (ISO 19566-5, Annex B) containing the assertion data. These Content Type boxes may be of either CBOR Content Type (<code>cbor</code>), JSON Content Type (<code>json</code>), Embedded File Content Type (<code>bfdb</code>) or UUID Content Type (<code>uuid</code>).</p>
</div>
<div class="paragraph">
<p>The C2PA <a href="#_claims">Claim</a> box shall have a label of <code>c2pa.claim</code>, a UUID of <code>0x6332636C00110010800000AA00389B71</code> (<code>c2cl</code>) and shall consist of a single CBOR Content Type box (<code>cbor</code>).</p>
</div>
<div class="paragraph">
<p>The C2PA <a href="#_digital_signatures">Claim Signature</a> box shall have a label of <code>c2pa.signature</code>, a UUID of <code>0x6332637300110010800000AA00389B71</code> (<code>c2cs</code>) and shall consist of a single CBOR Content Type box (<code>cbor</code>).</p>
</div>
<div class="sect4">
<h5 id="_credential_storage">10.1.1.1. Credential Storage</h5>
<div class="paragraph">
<p>A C2PA Credential Store (VCStore) is a JUMBF superbox that shall contain one or more JSON Content Type boxes (ISO 19566-5, Annex B.4). It shall have a label of <code>c2pa.credentials</code> and a UUID of <code>0x6332766300110010800000AA00389B71</code> (<code>c2vc</code>).</p>
</div>
<div class="paragraph">
<p>When storing W3C Verifiable Credentials in a VCStore, each one shall be labelled with the value of the <code>id</code> field of the <code>credentialSubject</code> of the VC itself. Since the <code>id</code> is guaranteed to be unique, this ensures that the URI to that credential will be unique.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/JUMBF-Single-Credentials.svg" alt="C2PA Manifest Block with a Credential Store" width="301">
</div>
<div class="title">Figure 6. C2PA Manifest Block with Credentials</div>
</div>
</div>
<div class="sect4">
<h5 id="_ingredient_storage">10.1.1.2. Ingredient Storage</h5>
<div class="paragraph">
<p>When a C2PA Manifest includes <a href="#_ingredients">ingredient assertions</a>, and an ingredient contains a C2PA manifest, that manifest must be brought into this asset to ensure that the provenance data is kept intact. Such ingredient manifests are added to the C2PA Manifest Store as a child of the C2PA Manifest for the asset itself.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/JUMBF-Single-Ingredients.svg" alt="C2PA Manifest Block with an Ingredient" width="301">
</div>
<div class="title">Figure 7. C2PA Manifest Block With an Ingredient</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_embedding_manifests_into_assets">10.2. Embedding manifests into assets</h3>
<div class="sect3">
<h4 id="_embedding_manifests_into_non_bmff_based_assets">10.2.1. Embedding manifests into non-BMFF-based assets</h4>
<div class="paragraph">
<p>When embedding the C2PA Manifest Store into an asset, the location will vary based on the type of the asset. Here are some well-known types and the location to use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JPEG: <strong>APP11</strong> Marker as defined in <a href="https://www.iso.org/standard/66071.html">JPEG XT, ISO/IEC 18477-3</a>. A single marker segment in JPEG-1 cannot be larger than 64K, so it is likely that multiple <strong>APP11</strong> segments will be required, and they will be constructed as per the JPEG-1 standard and <a href="https://www.iso.org/standard/73604.html">ISO 19566-5, D.2</a>. Writers of multiple segments should write them in sequential order, though they need not be contiguous.</p>
</li>
<li>
<p>PNG: An ancillary, private, not safe to copy, chunk type of <code>'caBX'</code> (as per <a href="https://www.w3.org/TR/2003/REC-PNG-20031110/">PNG, 4.7.2</a>).</p>
</li>
<li>
<p>PDF: An embedded file specification (ISO 32000, 7.11.3) which is referenced from the <code>EmbeddedFiles</code> NameTree (<code>/Catalog/Names/EmbeddedFiles</code>) as well as the value of the <strong>AF</strong> key in the document catalog dictionary. The file specification dictionary shall have an <strong>AFRelationship</strong> key whose value is <em>C2PA_Manifest</em>.</p>
</li>
<li>
<p>BMFF-based formats: A <code>'c2pa'</code> box.  Refer to <a href="#_embedding_manifests_into_bmff_based_assets">Section 10.2.2, &#8220;Embedding manifests into BMFF-based assets&#8221;</a> for more information.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional locations for other file formats will be added in the future.</p>
</div>
</div>
<div class="sect3">
<h4 id="_embedding_manifests_into_bmff_based_assets">10.2.2. Embedding manifests into BMFF-based assets</h4>
<div class="sect4">
<h5 id="_filetypebox">10.2.2.1. FileTypeBox</h5>
<div class="paragraph">
<p>A BMFF file that includes an embedded manifest shall include 'c2pa' in the compatible_brands list in the FileTypeBox (<code>'ftyp'</code>).</p>
</div>
</div>
<div class="sect4">
<h5 id="_the_c2pa_box">10.2.2.2. The <code>c2pa</code> Box</h5>
<div class="paragraph">
<p>All BMFF-based C2PA assets, whether they are timed (e.g., videos with or without audio tracks), untimed (e.g., still photos) or mixed (e.g., live or animated photos) audiovisual media, shall use a <code>'c2pa'</code> box that adheres to the following syntax and semantics:</p>
</div>
<div class="paragraph">
<p>Syntax</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>aligned(8) class ContentProvenanceBox extends FullBox(`'c2pa'`, version = 0, 0) {
    string box_purpose;
    bit(32) id;
    bit(8) data[];
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Semantics</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[indicates purpose of box]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[depends on box_purpose]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[depends on box_purpose]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The box_purpose and fields that depend on it are described below for each box purpose.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Regarding unique ids:</p>
</div>
<div class="paragraph">
<p>There are cases, such as fragmented MP4 (fMP4), where the id for a subset of the asset, such as the track_id field of the <code>'tkhd'</code> box, is only locally unique to a subset of the overall asset rather than globally unique to the asset.</p>
</div>
<div class="paragraph">
<p>Because a globally unique id is required to determine what to hash, a unique id is included.  This unique id does not equal any value from the original asset; each value is instead defined when the manifest is created.  The unique id is then combined with an associated local id to form an id that&#8217;s globally unique to the entire asset.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_box_containing_the_manifest">10.2.2.3. Box Containing the Manifest</h5>
<div class="paragraph">
<p>The box containing the manifest shall appear before the first <code>'mdat'</code> box in the file.</p>
</div>
<div class="paragraph">
<p>The fields in the corresponding box described above shall be set as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For a manifest, this value shall be <code>manifest</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>manifest</code>, this value shall be a unique integer used to differentiate local ids - see note regarding unique ids above.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>manifest</code>, the first 8 bytes shall be the absolute file offset to the first <code>'c2pa'</code> box with box_purpose equal to <code>merkle</code>.  If this file contains no such boxes, the first 8 bytes shall be zero.  Those 8 bytes shall be followed by the raw manifest bytes followed by zero or more unused padding bytes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_auxiliary_boxes_for_large_and_fragmented_files">10.2.2.4. Auxiliary Boxes for Large and Fragmented Files</h5>
<div class="paragraph">
<p>Some files have one or more very large <code>'mdat'</code> boxes (e.g., large video or image files which may be downloaded and rendered progressively) or large numbers of independent 'mdat' boxes (e.g., fMP4 where each fragment can be downloaded independently).</p>
</div>
<div class="paragraph">
<p>In these cases, it is unreasonable to require a client to completely download all <code>'mdat'</code> box(es) before verifying any portion of the asset.  Avoiding that necessity is resolved as follows.</p>
</div>
<div class="paragraph">
<p>The portion of the manifest containing the BMFF Hash shall include the <code>merkle</code> field.  Refer to <a href="#_hashing_a_bmff_formatted_asset_using_an_exclusion_list">[_hashing_a_bmff_formatted_asset_using_an_exclusion_list]</a> for more information.</p>
</div>
<div class="paragraph">
<p>For large <code>'mdat'</code> boxes that can be verified piecemeal, two or more of the above boxes shall be included in the single asset file.  They shall follow the last <code>'mdat'</code> box in the file.  The hash used for a given leaf node in the merkle tree shall be computed over an individual chunk of samples as defined by the <code>'stco'</code> or <code>'co64'</code> box.  All such <code>'c2pa'</code> boxes shall occur in the same sequence as the chunks they hash.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>For untimed-media, the <code>'stco'</code>/<code>'co64'</code> box is not present and thus cannot be used to determine hash division points for large <code>'mdat'</code> boxes.
For HEIF and AVIF, information in the <code>'iloc'</code> ("item location") box can be used for this purpose.
Are there other scenarios where an <code>'mdat'</code> can be large enough to be worth dividing?  If so, what box(es) should be used to decide on division points?</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For fragmented mp4 files where a single fragment contains a single <code>'mdat'</code>, a single instance of the above boxes shall be included in each fragment file.  It shall follow the <code>'moof'</code> box and precede the <code>'mdat'</code> box.  The hash used for a given leaf node in the merkle tree shall be over the entire <code>'mdat'</code> box in that fragment.</p>
</div>
<div class="paragraph">
<p>Regardless of which box is being used and how the asset is structured, the fields in the corresponding box described above shall be set as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">box_purpose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For an auxiliary box, this value shall be <code>merkle</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>merkle</code>, this value shall be a unique integer used to differentiate local ids - see note regarding unique ids above</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When box_purpose is <code>merkle</code>, this value shall contain raw manifest bytes indicating how to verify a portion of the asset as defined as follows.  If there are multiple <code>'c2pa'</code> boxes with box_purpose <code>merkle</code>, each shall be followed by sufficient padding bytes (zero or more) to make all <code>'c2pa'</code> boxes for this merkle tree a fixed size.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When there are more than one of these boxes in a single file, i.e., the case where there are large <code>'mdat'</code>(s) being verified piecemeal, a fixed size is required in order to enable a progressively downloading client to only download the boxes it needs to begin verification rather than the entire merkle tree.  Such a client can download enough of the first of these boxes based on the file offset in the <code>manifest</code> to determine if its uniqueId and localId match the 'mdat' it is trying to verify.  If they do, it can determine the file offset to the box it needs to verify the current chunk verifying by multiplying the chunk number by that size then download just that box.  Otherwise, it can determine the file offset to the beginning of the next merkle tree by multiplying that fixed size by the current merkle tree&#8217;s total number of leaf nodes, and it can repeat this process until it locates the box it needs.  The total download size for this subset of boxes is very small relative to the size of a single chunk.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/bmff-merkle/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The data structure used to store sufficient information to verify a single 'mdat' box or a portion of an 'mdat' box when a Merkle tree is used"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"uniqueId"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"localId"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"location"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"uniqueId"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w">  </span><span class="s2">"A unique integer used to differentiate local ids"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"localId"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w">  </span><span class="s2">"A local id indicating which 'mdat' box this entry pertains to.  This may not be globally unique."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w">  </span><span class="s2">"Zero-based index into the leaf-most merkle tree row corresponding to this 'mdat' box or portion of this 'mdat' box"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"hashes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An ordered array representing the set of additional hashes required to reach a hash in the merkle tree specified in the manifest from leaf-most (peer of this node) to root-most (child of node in manifest).  Note that this array may not be present, e.g. if the manifest itself contains the leaf-most set of hashes.  Null hashes are not included in this array.  The algorithm used shall be determined using the `alg` field from the corresponding entry in the `merkle` field array in the BMFF hash structure."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"minItems"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"description"</span><span class="p">:</span><span class="w">  </span><span class="s2">"A single hash from the merkle tree"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For files that use a <code>'tkhd'</code> box to indicate individual tracks, the localId in the preceding CBOR shall be set to the track_id field of the <code>'tkhd'</code> box pertaining to the <code>'mdat'</code> being hashed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">EDITORS NOTE</div>
<div class="paragraph">
<p>For untimed-media (e.g., images) and mixed media (e.g., a single BMFF asset containing both audio/video and an image), a <code>tkhd</code> box alone cannot be used to reference the complete set of different <code>mdat</code> boxes when there are more than one; it may not be present at all.
For scenarios such as these, what box value(s) should be used for localId instead?</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dynamic_stream_generation">10.2.3. Dynamic stream generation</h4>
<div class="paragraph">
<p>Many adaptive bitrate streaming (ABR) implementations store a single version of an asset, e.g., as a flat MP4 or in another intermediate format, and generate individual asset streams using various codecs, bitrates, etc. at consumption time. As a result, such a server must either hash said streams and create a manifest each time the content is consumed or, if generation is deterministic, create and cache the hashes and manifests once and then embed them at consumption time.</p>
</div>
<div class="paragraph">
<p>This also means that such a server must have a signing identity of its own that will be trusted by validators or be able to sign the generated files on behalf of the content creator in a secure and trustworthy manner.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exclusion_list_requirements">10.2.4. Exclusion List Requirements</h4>
<div class="paragraph">
<p>For all BMFF files where a <code>'c2pa'</code> box includes C2PA information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>xpath = "/c2pa"
version = 0
flags = "AAAA"</code></pre>
</div>
</div>
<div class="paragraph">
<p>All boxes present that specify absolute or relative file offsets shall be excluded in whole or in part.</p>
</div>
<div class="paragraph">
<p>The following are examples of entire boxes that shall be excluded (when present).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>xpath = "/moov/trak/mdia/minf/stbl/stco"
version = 0
flags = "AAAA"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>xpath = "/moov/trak/mdia/minf/stbl/co64"
version = 0
flags = "AAAA"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following is an example of excluding a partial box.  (When a <code>'tfhd'</code> box is present and its flags has bit <code>0x000001</code> set, only the base_data_offset field from the box shall be excluded.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>xpath = "/moof/traf/tfhd"
version = 0
flags = "AAAJ"
data = [ { 12, "AQAAAA==" } ]
subset = [ { 16, 8 } ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The flags field is the unpadded base64 encoding of the bytes <code>0x00 0x00 0x09</code> indicating that flags <code>0x000001</code> and <code>0x000008</code> are set. For <code>tfhd</code>, this effectively means that the box (including size and type) is 28 bytes long.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>4 byte size</p>
</li>
<li>
<p>4 byte box type <code>tfhd</code></p>
</li>
<li>
<p>1 byte version</p>
</li>
<li>
<p>3 byte flags</p>
</li>
<li>
<p>4 byte track_id</p>
</li>
<li>
<p>8 byte base_data_offset</p>
</li>
<li>
<p>4 byte default_sample_duration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The data field is set to the unpadded base64 encoding of the bytes <code>0x01 0x00 0x00 0x00</code> at offset 12.</p>
</div>
<div class="paragraph">
<p>This exclusion refers only to a 'tfhd' box with its track_id set to 1 (big-endian).
It is excluding only the base_data_offset field which is at offset 16 bytes from the start of the <code>'tfhd'</code> box and is 8 bytes long.
This field must be excluded because it is a file offset and including it would invalidate the hash once the manifest was embedded into the file.</p>
</div>
<div class="paragraph">
<p>All other portions of the box are included in the hash, i.e., bytes 0-15 and 25-28.
Thus, the 4 byte default_sample_duration field at offset 25 <strong>is</strong> included in the hash.
Failing to include that field in the hash would enable the audio/video speed to be increased or decreased without invalidating the hash, thus defeating a stated goal of C2PA.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timed_media_streams_that_are_neither_audio_nor_video">10.2.5. Timed-media streams that are neither audio nor video</h4>
<div class="paragraph">
<p>Timed-media streams that are neither audio nor video, such as text streams for captions, that the claim generator wishes to make tamper evident shall be handled the same way as audio and video streams.</p>
</div>
</div>
<div class="sect3">
<h4 id="_external_references">10.2.6. External references</h4>
<div class="paragraph">
<p>Externally referenced content declared inside BMFF boxes, such as in a <code>'dref'</code>, <code>'url'</code>, or <code>'urn'</code> box, that the claim generator wishes to make tamper evident shall <strong>not</strong> exclude the referencing box AND shall include a separate <a href="#_cloud_data">cloud data assertion</a> for each external reference to be hashed.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_entity_diagram">11. Entity Diagram</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following diagram provides a look at how all of the pieces of the C2PA system integrate and relate to each other.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/C2PA_Entity_Diagram.svg" alt="C2PA Entity Diagram" width="612">
</div>
<div class="title">Figure 8. C2PA Entity Diagram</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cryptography">12. Cryptography</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_hashing">12.1. Hashing</h3>
<div class="paragraph">
<p>All cryptographic hashes that are stored in C2PA data structures (e.g., claim or assertions) shall be generated using one of the hash algorithms listed as supported by the C2PA data hash algorithm registry (TBD). This registry will define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of hash algorithms that are allowed for generating hashes of new content as well as required for validating hashes of existing content (the "allowed" list), and</p>
</li>
<li>
<p>A list of hash algorithms that are required to be supported for validating hashes of existing content but are not allowed for generating hashes of new content (the "deprecated" list).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is a separate registry for soft binding algorithms.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>An algorithm must appear in no more than one list. An algorithm that is instantiated over multiple output lengths will be considered different algorithms for this purpose, and each instantiation must be listed. If an algorithm does not appear in either list, it is forbidden and must not be used. Algorithms can be removed from the lists in order to implement forbidding an algorithm.</p>
</div>
<div class="paragraph">
<p>This list will establish the allowed algorithms for creating hashes and a string algorithm identifier to be used as the algorithm identifier in the corresponding field. The outputs of hash functions shall be stored as their binary values encoded into CBOR as byte strings (major type 2) with a declared length. Wherever a field contains the output of a hash function, an algorithm identifier string field shall be present within the same structure, or within an enclosing structure, to declare which algorithm was used. A hash algorithm identifier field should be present in exactly one of these places, but if more than one is present within the structure and its enclosing structures, the nearest identifier must be used. Nearest is defined first as an identifier that is a sibling field of the hash value, and then the immediately enclosing structure, up to the root structure.</p>
</div>
<div class="paragraph">
<p>If the C2PA&#8217;s data hash algorithm registry has not yet been established, then the registry (the "bootstrap registry") shall contain an empty deprecated list, and the allowed list shall be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SHA2-256 ("sha256")</p>
</li>
<li>
<p>SHA2-384 ("sha384")</p>
</li>
<li>
<p>SHA2-512 ("sha512")</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is recommended that the string identifiers for hash algorithms conform to how they are referred to in common practice although there is no set standard. In particular, in keeping with their description in RFC 6234, the string identifiers for variants of SHA-2 are recommended to be "sha256," "sha384," and "sha512."</p>
</div>
<div class="paragraph">
<p>When the C2PA data hash algorithm registry is established, the bootstrap registry shall have no effect as if it did not exist. Algorithms not present in the established data hash algorithm registry are not permitted regardless of their inclusion in the bootstrap registry.</p>
</div>
</div>
<div class="sect2">
<h3 id="_digital_signatures">12.2. Digital Signatures</h3>
<div class="paragraph">
<p>All digital signatures that are stored in a C2PA data structure (e.g., claim or assertion) shall be generated using one of the digital signature algorithms and key types listed as supported by the C2PA digital signature algorithm and key type registry (TBD). COSE groups digital signatures and key types together, and the registry will follow this pattern. This registry will define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A list of digital signature algorithms and key types that are allowed for generating signatures of new content as well as required for validating signatures of existing content (the "allowed" list), and</p>
</li>
<li>
<p>A list of digital signature algorithms and key types that are required to be supported for validating signatures of existing content but are not allowed for generating signatures of new context (the "deprecated" list).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This list will establish the allowed algorithms and key types by referencing an algorithm identifier from the relevant standards that define algorithms for COSE and their mappings to CBOR identifiers, including but not limited to RFC 8152 and RFC 8230. These standards also specify the hash algorithm used in the signature scheme. Nothing in <a href="#_hashing">Section 12.1, &#8220;Hashing&#8221;</a> shall apply to this use of hash algorithms; if a digital signature algorithm is present in the digital signature algorithm and key type registry, the use of its specified hash algorithm in the signature scheme shall be allowed and followed.</p>
</div>
<div class="paragraph">
<p>If the digital signature algorithm and key type registry has not yet been established, then the registry (the "bootstrap registry") of digital signature algorithm and key type identifiers shall be an empty deprecated list, and the allowed list shall be as follows. The parenthetical notes are explainers provided only as an aid to the reader.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ES256 (ECDSA using P-256 and SHA-256)</p>
</li>
<li>
<p>ES384 (ECDSA using P-384 and SHA-384)</p>
</li>
<li>
<p>ES512 (ECDSA using P-521 and SHA-512)</p>
</li>
<li>
<p>PS256 (RSASSA-PSS using SHA-256 and MGF1 with SHA-256)</p>
</li>
<li>
<p>PS384 (RSASSA-PSS using SHA-384 and MGF1 with SHA-384)</p>
</li>
<li>
<p>PS512 (RSASSA-PSS using SHA-512 and MGF1 with SHA-512)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the C2PA digital signature algorithm and key type registry is established, the bootstrap registry shall have no effect as if it did not exist. Algorithms not present in the established digital signature algorithm and key type registry are not permitted regardless of their inclusion in the bootstrap registry.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This list intentionally excludes RS256, RS384, and RS512 which are the RSA variants that use PKCS#1v1.5 instead of PSS as the signature scheme. Though nothing precludes these algorithms from being added to the C2PA supported list when it is established, with no requirement to support legacy code, the problems with PKCS#1v1.5 signature due to Bleichenbacher&#8217;s attack are best avoided.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The signature for the CBOR-encoded claim is produced by CBOR Object Signing and Encryption (COSE) as described in RFC 8152 sections 4.2 and 4.4. The signature shall be either a <code>COSE_Sign1</code> or <code>COSE_Sign1_Tagged</code> structure as stated in the specification of the structure being signed. In the output, it is recommended that the structure being signed is enclosed in the <code>COSE_Sign1</code> structure as the payload parameter to avoid the need to define an additional structure to contain the signed version of said structure, and that <code>COSE_Sign1</code> structure is used as the envelope. It is allowed to elect a "detached mode" where a custom envelope is defined to carry the signature in which case the contents of the signature field shall be the serialized <code>COSE_Sign1</code> (or <code>COSE_Sign1_Tagged</code>) structure with the payload field set to nil.</p>
</div>
<div class="paragraph">
<p>The signature is cryptographically verified as described in RFC 8152 section 4.4.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trust_model">13. Trust Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_4">13.1. Overview</h3>
<div class="imageblock">
<div class="content">
<img src="images/TrustModel.svg" alt="Diagram" width="720" height="238">
</div>
</div>
<div class="paragraph">
<p>The above model shows, in colour, the three entities specified here in the trust model, which is concerned with trust in a signer&#8217;s identity. In dashed lines, below, is the consumer (who is not specified in the trust model), who uses the identity of the signer, along with other trust signals, to decide whether the assertions made about an asset are true.</p>
</div>
</div>
<div class="sect2">
<h3 id="_identity_of_signers">13.2. Identity of Signers</h3>
<div class="paragraph">
<p>Identity in the trust model is the means by which a cryptographic signing key is associated with an actor for the basis of making trust decisions based on any structure (including, but not limited to, claims and manifests) signed with that key. The identity of a signatory is not necessarily a human actor, and the identity presented may be a pseudonym, completely anonymous, or pertain to a service or trusted hardware device with its own identity, including an application running inside such a service or trusted hardware.</p>
</div>
<div class="paragraph">
<p>All signed structures in C2PA use <code>COSE_Sign1</code> structures. The credential should be listed in the unprotected headers. The credential may appear in the protected headers, though as all credential types are themselves signed objects and so carry their own integrity protection, this is not necessary. Regardless, exactly one instance of an identity credential must appear in the union of the protected and unprotected headers. <code>COSE_Sign1</code> structures with no credentials, or two or more credentials, must be rejected. Repeating the same credential more than once, including separately in the protected and unprotected headers, is also an instance of two or more credentials and must be rejected.</p>
</div>
<div class="paragraph">
<p>Each credential type will define the following data to be provided to the validator:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How the credential is stored in the header value,</p>
</li>
<li>
<p>How a trust chain is computed from the signatory to an entry in the validator&#8217;s trust anchor list,</p>
</li>
<li>
<p>The public key in the credential used to validate the signature, and</p>
</li>
<li>
<p>The time validity period of the credential.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The name of the header to indicate credential type, how the credential is stored in the header value, and how trust chains are constructed are specified for each credential type below.</p>
</div>
<div class="sect3">
<h4 id="_x_509_certificates">13.2.1. X.509 Certificates</h4>
<div class="paragraph">
<p>X.509 Certificates are stored in a header named <code>x5chain</code> <a href="https://datatracker.ietf.org/doc/draft-ietf-cose-x509/">draft-ietf-cose-x509</a>. The value is a CBOR array of byte strings, each of which contains the certificate encoded as ASN.1 distinguished encoding rules (DER). This array must contain at least one element. The first element of the array must be the certificate of the signer, and the <code>subjectPublicKeyInfo</code> element of the certificate will be the public key used to validate the signature. The <code>Validity</code> member of the <code>TBSCertificate</code> sequence provides the time validity period of the certificate.</p>
</div>
<div class="paragraph">
<p>A signer may supply additional certificates, such as intermediate certificate authorities (CAs), to aid a validator in trust chain building. These certificates are included as additional elements of the array, and each is also a byte string containing the DER encoding of the certificate. Each subsequent certificate must be the one used to issue and certify the previous certificate.</p>
</div>
<div class="sect4">
<h5 id="_anonymous_and_pseudonymous_certificates">13.2.1.1. Anonymous and Pseudonymous Certificates</h5>
<div class="paragraph">
<p>Anonymous or pseudonymous certificates can be achieved by generating and using a self-signed certificate with no personally identifying information present in the certificate. Applications that generate self-signed certificates for this purpose should endeavor to adhere to the Certificate Profile below, although some requirements do not apply to self-signed certificates. Applications must convey to signers requesting an anonymous certificate that all assets signed with the same certificate are unavoidably linked to one another, and any later exposure of the signer&#8217;s identity can be imputed to all assets signed with that credential. Self-signed certificates must be explicitly trusted by validators. If compromised, the self-signed nature of such certificates precludes their revocation through in-band means.</p>
</div>
<div class="paragraph">
<p>Anonymous or pseudonymous certificates can also be achieved by using a trusted third party acting as a certificate authority, which does not publish in certificates personally identifying information. The standards by which these trusted third parties can appear in trust lists are beyond the scope of this trust model, but if adopted, would follow all the same requirements for typical certificates that do identify the signatory. Such trusted third parties should make similar warnings about the ability to link assets signed with a credential in addition to other appropriate education in identity protection.</p>
</div>
</div>
<div class="sect4">
<h5 id="_certificate_profile">13.2.1.2. Certificate Profile</h5>
<div class="paragraph">
<p>All certificates must be signed with an algorithm supported by the C2PA certificate signature algorithm list (TBD). These identifiers are taken from the relevant standards including, but not limited to, RFC 3279, RFC 5758, and RFC 8017 which define their mappings to object identifiers (OIDs).</p>
</div>
<div class="paragraph">
<p>If the C2PA&#8217;s certificate signature algorithm list has not yet been established, then the list (the "bootstrap list") shall be as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ecdsa-with-SHA256</p>
</li>
<li>
<p>ecdsa-with-SHA384</p>
</li>
<li>
<p>ecdsa-with-SHA512</p>
</li>
<li>
<p>sha256WithRSAEncryption</p>
</li>
<li>
<p>sha384WithRSAEncryption</p>
</li>
<li>
<p>sha512WithRSAEncryption</p>
</li>
<li>
<p>id-RSASSA-PSS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the C2PA list is established, the bootstrap list shall have no effect as if it did not exist. Algorithms not present in the established list are not permitted regardless of their inclusion in the bootstrap list.</p>
</div>
<div class="paragraph">
<p>All certificates issued by a CA must conform to the following profile and shall be rejected if they do not. Self-signed certificates should conform to the profile below but shall not be rejected for violations if present in an "address book" trust list described below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version must be v3. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.1">RFC 5280 section 4.1.2.1</a></p>
</li>
<li>
<p>The <code>issuerUniqueID</code> and <code>subjectUniqueID</code> optional fields of the <code>TBSCertificate</code> sequence must not be present. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.8">RFC 5280 section 4.1.2.8</a></p>
</li>
<li>
<p>The Basic Constraints extension must follow <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1.2.9">RFC 5280 section 4.2.1.9</a>. In particular, it must be present with the <code>cA</code> boolean asserted if the certificate issues certificates.</p>
</li>
<li>
<p>The Authority Key Identifier extension must be present in any certificate that is not self-signed. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.1">RFC 5280 section 4.2.1.1</a></p>
</li>
<li>
<p>The Subject Key Identifier extension must be present in any certificate that is not self-signed and acts as a CA. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.2">RFC 5280 section 4.2.1.2</a></p>
</li>
<li>
<p>The Key Usage extension must be present and should be marked as critical. Certificates used to sign C2PA structures must assert the <code>digitalSignature</code> bit. The <code>keyCertSign</code> bit must only be asserted if the <code>cA</code> boolean is asserted in the Basic Constraints extension. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.3">RFC 5280 section 4.2.1.3</a></p>
</li>
<li>
<p>The Extended Key Usage extension must be present and non-empty in any certificate where the Basic Constraints extension is absent or the <code>cA</code> boolean is not asserted. These are commonly called "end entity" or "leaf" certificates. <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.2.1.12">RFC 5280 section 4.2.1.12</a></p>
<div class="ulist">
<ul>
<li>
<p>The <code>anyExtendedKeyUsage</code> EKU (2.5.29.37.0) must not be present.</p>
</li>
<li>
<p>A certificate that signs C2PA structures must be valid for the <code>id-kp-emailProtection</code> (1.3.6.1.5.5.7.3.4) purpose. [ Editor&#8217;s note: This is a placeholder. We may want to define our own EKU for this. ]</p>
</li>
<li>
<p>A certificate that signs timestamping countersignatures must be valid for the <code>id-kp-timeStamping</code> (1.3.6.1.5.5.7.3.8) purpose.</p>
</li>
<li>
<p>A certificate that signs OCSP responses for certificates must be valid for the <code>id-kp-OCSPSigning</code> (1.3.6.1.5.5.7.3.9) purpose.</p>
</li>
<li>
<p>A certificate must not be valid for more than one of the three purposes listed above.</p>
</li>
<li>
<p>A certificate should not be valid for any other purposes outside of the purposes listed above, but the presence of any other EKUs shall not cause the certificate to be rejected.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_certificate_trust_chain">13.2.1.2.1. Certificate Trust Chain</h6>
<div class="paragraph">
<p>The trust chain must be built and validated according to the procedure in <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-6">RFC 5280 section 6</a> for the particular purpose required (signing, timestamping, or OCSP signing) and for the appropriate trust list for that purpose. A validator must consider any supplemental certificates provided in building trust chains and may choose to attempt to fetch intermediate certificates on its own. Any failure of that validation algorithm shall mean the chain must be rejected.</p>
</div>
<div class="paragraph">
<p>Only end entity certificates shall be used to sign C2PA structures or timestamps. A CA certificate must not be used for these purposes. Any chain that terminates in a CA certificate being used to validate a  signature, timestamp, or OCSP response must be rejected.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_certificate_revocation">13.2.1.3. Certificate Revocation</h5>
<div class="paragraph">
<p>X.509 certificates support revocation status queries. C2PA uses the Online Certificate Status Protocol (OCSP) and OCSP stapling to implement revocation. C2PA does not use Certificate Revocation Lists (CRLs).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Using CRLs requires downloading the entire list of revoked certificates for each Certificate Authority encountered, which can be time-consuming. Although a CRL could be included in the same way an OCSP response is stapled, the potential size of a CRL relative to an OCSP response also makes this undesirable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A conforming CA must not use Certificate Revocation Lists (CRLs) nor include a <code>cRLDistributionPoints</code> extension (section 4.2.1.13) in the certificate. A conforming CA should include an AuthorityInfoAccess (AIA) extension (section 4.2.2.1) to provide access information for an Online Certificate Status Protocol (OCSP) service operated by the CA.</p>
</div>
<div class="paragraph">
<p>If the certificate has an AIA header, revocation information shall be stored in an unprotected header of the <code>COSE_Sign1</code> structure named <code>rVals</code> and shall follow <a href="https://www.etsi.org/deliver/etsi_ts/119100_119199/11918201/01.01.01_60/ts_11918201v010101p.pdf">JAdES section 5.3.5.2</a>, with the following modifications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>ocspVals</code> property shall be present. As C2PA uses CBOR, each item of <code>ocspVals</code> shall contain the DER-encoded <code>OCSPResponse</code> defined in <a href="https://tools.ietf.org/html/rfc6960">RFC 6960</a>as a byte string, instead of a Base64-encoded version of the same.</p>
</li>
<li>
<p>The <code>crlVals</code> property shall not be present. If present, a validator shall ignore its contents, but shall not reject the certificate due to this header being present.</p>
</li>
<li>
<p>The <code>otherVals</code> property shall not be present. If present, a validator shall ignore its contents, but shall not reject the certificate due to this header being present.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before signing a claim, if a signer&#8217;s certificate has the AIA extension, a signer should query the OCSP service indicated therein, capture the response, and store it in an element of the <code>ocspVals</code> array of the <code>rVals</code> header.</p>
</div>
<div class="paragraph">
<p>A validator should reject a manifest where the signer&#8217;s certificate contains the AuthorityInfoAccess extension but the manifest does not contain an <code>rVals</code> header with an <code>ocspVals</code> entry that corresponds to the signer&#8217;s certificate.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This is currently a "should" rather than a "must" given that revocation is difficult to implement. Unlike the TLS case, we should not be at the mercy of temporary outages of the OCSP responder; indeed, a temporary failure of the OCSP responder would result in a delay at signing time, as it would delay when the creator could get the OCSP response to include but would not affect validation time. In some cases, a signer may choose to publish without revocation information if the OCSP responder is offline, and there is a time pressure for the signer to publish.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>rVals</code> header establishes that the signer&#8217;s certificate is not revoked if:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The manifest is also timestamped, and the attested time falls within the <code>(thisUpdate,nextUpdate)</code> interval of the OCSP response for the signer&#8217;s certificate,</p>
</li>
<li>
<p>The <code>certStatus</code> field of the OCSP response for the signer&#8217;s certificate is <code>good</code>, and</p>
</li>
<li>
<p>The signer of the OCSP response is an "authorized responder" as defined by section 4.2.2.2 of <a href="https://tools.ietf.org/html/rfc6960">RFC 6960</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
At this time, we are not addressing checking that an authorized responder itself may have been revoked, as described in section 4.2.2.2.1 of <a href="https://tools.ietf.org/html/rfc6960">RFC 6960</a>. We are also not currently considering potential revocation of intermediate CAs on the path from the signer&#8217;s certificate to the trust anchor.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_signer_credential_trust">13.3. Signer Credential Trust</h3>
<div class="paragraph">
<p>A validator shall maintain the following trust lists:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For each credential type:</p>
<div class="ulist">
<ul>
<li>
<p>Trust anchors for C2PA signers,</p>
</li>
<li>
<p>Trust anchors for Time Stamping Authorities.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Issuers can appear on more than one list, in which case they are trusted to issue credentials for both purposes. Time stamping authorities must adhere to the requirements in section 2.1 of <a href="https://tools.ietf.org/html/rfc3161">RFC 3161</a>.</p>
</div>
<div class="paragraph">
<p>In this section, "user" refers to human actors that are using C2PA-compliant validators in consumption and authoring scenarios.</p>
</div>
<div class="paragraph">
<p>A validator should allow these trust lists to be configured by the user but should provide default options or offer lists maintained by external parties that the user may opt into.</p>
</div>
<div class="paragraph">
<p>A validator should provide a list of time stamping authority trust anchors. A validator should allow users to customize this list, but should caution users against doing so, given the heightened security standards trusted timestamping authorities are held to.</p>
</div>
<div class="paragraph">
<p>A validator may also allow the user to maintain an "address book" of credentials they have chosen to trust based on an out-of-band relationship. For example, a journalist may choose to add sources to their personal address book to facilitate accepting and validating media with C2PA provenance data attached, even though the sources themselves would have no reason to be on an externally-maintained trust list used broadly by the general public. To facilitate accepting content from such contacts, no violations of the Certificate Profile above will cause claims signed by entries in the address book to be rejected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_identity_in_assertions">13.4. Identity In Assertions</h3>
<div class="paragraph">
<p>Some assertions (such as <code>schema.org.CreativeWork</code>) allow a person&#8217;s identity to be associated in a defined way with the asset. This identity is purely scoped via the definition in each assertion and does not imply any larger involvement or responsibility for any assertion made in the claim, or the asset itself. All assertions, as stated below, are made by a signer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_statements">13.5. Statements</h3>
<div class="paragraph">
<p>A validator is a manifest consumer that will produce some <a href="#_validation">validation</a> statements about that asset. The consumer of the asset, usually through their user agent and its user interface, then has to interpret those statements to arrive at a set of conclusions of their own about the provenance of the asset they are consuming. These conclusions will be drawn from these statements, the set of trust relationships that consumer currently has with the actors in the asset, and the contents of the asset itself.</p>
</div>
<div class="paragraph">
<p>A validator can make the following true or false statements about the asset they are validating, and no more.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
"not independently verified" is used to indicate that an assertion (like a parent ingredient) has been made by the signer of the claim and has not been verified by another party.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The active manifest has not been modified since the active manifest was signed</p>
</li>
<li>
<p>The portions of the asset that are covered by asset and metadata hashes have not been modified since the active manifest was produced</p>
</li>
<li>
<p>The claim was produced by a claim generator (typically software), and signed by an actor identified in the subject field of the signing credential</p>
</li>
<li>
<p>The assertions of the active manifest are statements by the signer and their contents are not independently verified</p>
</li>
<li>
<p>The assertions of the active manifest have not been modified since the active manifest was produced</p>
</li>
<li>
<p>The assets referred to by ingredient assertions are not (necessarily) available at validation of the active manifest, and therefore their hashes cannot be verified</p>
</li>
<li>
<p>The ingredient assertion may contain a <a href="https://schema.org/ClaimReview">ClaimReview</a>, that indicates the active manifest signer&#8217;s assessment of the verification state of the ingredient asset&#8217;s hashes at the time of adding the ingredient</p>
</li>
<li>
<p>The content of ingredient assertions, like all other assertions, is not independently verified</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validation">14. Validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The active manifest of an asset is valid only if all the steps in this section are successful. This validation must be completed before a validator presents a successful result to a human user or begins to render any content. Validating content as it is rendered to the user is described in <a href="#_validate_the_assets_content">Section 14.9, &#8220;Validate the Asset&#8217;s Content&#8221;</a>.</p>
</div>
<div class="sect2">
<h3 id="_validate_the_claim">14.1. Validate the Claim</h3>
<div class="paragraph">
<p>If the asset contains XMP, then retrieve the value of the <code>dcterms:provenance</code> key from the XMP. If a <code>dcterms:provenance</code> key is not present in the XMP, then the asset should be considered as not containing C2PA information (ie. ``no claim''). When present, its value represents the URI reference to resolve to find the active manifest. Resolve the URI reference for the C2PA Manifest, retrieving the data.</p>
</div>
<div class="paragraph">
<p>For assets that do not contain XMP, the location of the active C2PA Manifest will be stored in some other location as specified in <a href="#_referencing_the_active_manifest">Section 9.3.3, &#8220;Referencing the Active Manifest&#8221;</a>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Editor&#8217;s Note</div>
<div class="content">
<div class="paragraph">
<p>More information about non-XMP-based methods will be specified here as they are developed.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_signature">14.2. Validate the Signature</h3>
<div class="paragraph">
<p>Retrieve the URI reference for the signature from the value of the claim&#8217;s <code>signature</code> field and resolve the URI reference to obtain the COSE signature. The signature must be embedded in the manifest as described in <a href="#_c2pa_box_details">Section 10.1.1, &#8220;C2PA Box details&#8221;</a>. If the signature URI does not refer to a location within the manifest (a <code>self#jumbf</code> location), the claim must be rejected. If no such field is present or the URI cannot be resolved, then the claim must be rejected.</p>
</div>
<div class="paragraph">
<p>Verify that the credential used in the signature is acceptable according to <a href="#_trust_model">Chapter 13, <em>Trust Model</em></a>. If it is not, then the claim must be rejected. After confirming it is acceptable, validation should proceed according to the specified procedure in <a href="#_digital_signatures">Section 12.2, &#8220;Digital Signatures&#8221;</a>. If validation of the signature fails, then the claim must be rejected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_time_stamp_if_present">14.3. Validate the Time Stamp (if present)</h3>
<div class="paragraph">
<p>If the <code>sigTst</code> header is not present, the claim is valid if the signer&#8217;s credential is valid at the current time.</p>
</div>
<div class="paragraph">
<p>If the <code>sigTst</code> header is present, the claim is valid if the <code>tstTokens</code> array contains at least one <code>tstToken</code> whose <code>val</code> property is an RFC3161-compliant <code>TimeStampToken</code> which satisfies the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The timestamp contains a message imprint as described in <a href="#_timestamps">Section 9.3.2.5, &#8220;TimeStamps&#8221;</a> that matches the claim being validated,</p>
</li>
<li>
<p>The time attested by the Time Stamping Authority (TSA) falls within the validity period of the signing credential,</p>
</li>
<li>
<p>The attested time falls within the validity period of the TSA&#8217;s signing certificate,</p>
</li>
<li>
<p>A trust chain can be built to an entry in the time stamping authority trust list as described in <a href="#_signer_credential_trust">Section 13.3, &#8220;Signer Credential Trust&#8221;</a>. Locating the TSA&#8217;s certificate in the timeStampToken is described in <a href="https://datatracker.ietf.org/doc/html/rfc3161#section-2.4.1">RFC 3161 section 2.4.1</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
At this time, the revocation status of a Time Stamping Authority&#8217;s certificate is neither captured at signing time nor validated at validation time.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_credential_revocation_information_if_present">14.4. Validate the Credential Revocation Information (if present)</h3>
<div class="paragraph">
<p>If the signer&#8217;s credential type does not support revocation status, or the credential&#8217;s issuer did not provide a method to query its revocation status, the validator presumes the credential is not revoked.</p>
</div>
<div class="paragraph">
<p>If the signer&#8217;s credential type supports revocation, and the credential&#8217;s issuer provided a method to query its revocation status:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the <code>rVals</code> header is present, its contents should be validated as described in the signer credential type&#8217;s description in <a href="#_trust_model">Chapter 13, <em>Trust Model</em></a>.</p>
</li>
<li>
<p>If the <code>rVals</code> header is not present, and the signer&#8217;s credential is valid at validation time, a validator may choose to query the credential status method to determine if the credential is currently revoked, which may differ from its status at the time of signing. Querying the credential status method can reveal to an observer the identity of the asset being validated, and so this query is optional. This query will also only reveal if the signer&#8217;s credential is valid at the current time, which may differ from its status at the time of signing. If the validator chooses to make this query, the response to the query shall determine the credential&#8217;s status. If the validator does not make this query, the credential shall be presumed not revoked.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When a signer&#8217;s credential is revoked, this does not invalidate manifests that were signed before the time of revocation. The inclusion of the <code>rVals</code> header combined with a timestamp provides proof that the signer&#8217;s credential was valid at the time of signing. Absent this information, because it is not possible to query the historical revocation status of a credential, only its status at validation time, a validator querying in this situation might reject a manifest if the signer&#8217;s credential was revoked after signing time. Signers are encouraged to include revocation information and time stamps to avoid this possibility.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In all cases, if the credential is deemed revoked, the claim must be rejected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_assertions_in_the_assets_claim">14.5. Validate the Assertions in the Asset&#8217;s Claim</h3>
<div class="paragraph">
<p>Each assertion in the <code>assertions</code> field of the claim is a <code>hashed_uri</code> structure. If the active manifest&#8217;s claim is being validated, the <code>active_redacted_assertions</code> list is empty. If an ingredient claim is being validated, the <code>active_redacted_assertions</code> list is an input to this recursive call. For each assertion, the validator must:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If the URI reference in the <code>url</code> field is present in the <code>active_redacted_assertions</code> list:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the assertion&#8217;s label is <code>c2pa.action</code>, the claim must be rejected.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>c2pa.action</code> assertions may not be redacted.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Otherwise, the redacted assertion is considered valid, and validation continues to the next assertion.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Otherwise, since the assertion is not redacted:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain its data. If the URI cannot be resolved and the data retrieved, the claim must be rejected.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If the URI refers to an external location and there is a temporary failure preventing its retrieval, the claim must not be accepted until all external references can be retrieved. The validator may indicate the temporary failure status and offer the option to render the asset with an unknown provenance state, as it would for an asset without a manifest.</p>
</li>
<li>
<p>Compute a hash of the data using the hash algorithm, determined by following the procedure described in <a href="#_hashing">Section 12.1, &#8220;Hashing&#8221;</a>:</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_uri</code> structure, that determines the hash algorithm.</p>
</li>
<li>
<p>If an <code>alg</code> field is not present in the <code>hashed_uri</code> strcuture, an <code>alg</code> field must be present in an enclosing structure, and the nearest instance present determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is found in any of these locations, the claim must be rejected.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Compare the computed hash value with the value in the <code>hash</code> field. If they do not match, the claim must be rejected.</p>
</li>
<li>
<p>Otherwise, the assertion is valid and validation continues to the next assertion.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Then, for each element of the claim&#8217;s own <code>redacted_assertions</code> array, if any element of the claim&#8217;s <code>assertions</code> array has a <code>url</code> field equal to that value, the claim must be rejected. A claim cannot redact its own assertions, only those of any ingredients.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As described in <a href="#_w3c_verifiable_credentials">Chapter 7, <em>W3C Verifiable Credentials</em></a>, any proofs present inside a Verifiable Credential are not validated. Like all contents of an assertion, C2PA only guarantees the contents of the credential are integrity-protected.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_recursively_verifying_integrity_of_ingredients">14.6. Recursively Verifying Integrity of Ingredients</h3>
<div class="paragraph">
<p>A validator must perform the above validation steps for the asset being presented and its manifest. If any of the above steps conclude the manifest is invalid, that manifest must be rejected.</p>
</div>
<div class="paragraph">
<p>An asset&#8217;s manifest may list one or more ingredients. A validator may optionally recurse through any ingredient manifests and verify the hash in the <code>hashed-uri</code> reference to check its integrity. There is no requirement that signers of ingredient manifests are trusted by the validator, and building of trust chains of signers of ingredients shall not be attempted. Instead, as the ingredient is included by the signer of the active manifest, and if the signer of the active manifest is accepted per the rules above, ingredient manifests will share in that trust for the purposes of this recursive validation. Applications should not display data from ingredient manifests with failed integrity checks. If the application chooses to display such data, it must flag the display with a warning about the failed integrity check, and that the data cannot be reliably attributed to the ingredient manifest&#8217;s signer nor to the asset&#8217;s manifest&#8217;s signer.</p>
</div>
<div class="paragraph">
<p>When ingredients are being added to an asset as part of an authoring workflow, the ingredient undergoes full validation. In this scenario, the ingredient&#8217;s manifest is considered the active manifest for validation purposes, before the ingredient is added to another asset&#8217;s ingredients.</p>
</div>
<div class="paragraph">
<p>For consumption scenarios, it is expected that problems with ingredient manifests would be ignored during normal consumption use but may be surfaced as a warning if a user opts to explore the provenance history. Indeed, a consumption application may opt not to do any recursive validation unless the user requests an exploration of the provenance history.</p>
</div>
<div class="paragraph">
<p>In authoring scenarios, it may be desirable to more prominently raise warnings so that a creator making use of such an asset with a flawed provenance history can make an informed decision of how to proceed.</p>
</div>
<div class="paragraph">
<p>If a validator chooses to validate ingredients, for each ingredient, it must recursively:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the ingredient does not have a <code>c2pa_manifest</code> field, the ingredient is accepted. Otherwise:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an <code>active_redacted_assertions</code> list which is the concatenation of the claim&#8217;s <code>redacted_assertions</code> array with any pre-existing <code>active_redacted_assertions</code> list from previous recursive calls. This list is therefore only the redacted assertions from the active manifest&#8217;s claim and any ingredients along the path to the current ingredient.</p>
</li>
<li>
<p>Resolve the URI reference in the <code>url</code> field to obtain the ingredient claim&#8217;s manifest. If the URI reference cannot be resolved, the ingredient claim is rejected. If the URI reference refers to an external location, and a temporary failure prevents retrieval of the claim, the claim cannot be accepted until it is retrieved. The validator may indicate this temporary failure status.</p>
</li>
<li>
<p>Determine the hash algorithm identifier as determined by following the procedure described in <a href="#_hashing">Section 12.1, &#8220;Hashing&#8221;</a>:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If an <code>alg</code> field is present in the <code>hashed_uri</code> structure, that determines the hash algorithm.</p>
</li>
<li>
<p>If an <code>alg</code> field is not present in the <code>hashed_uri</code> strcuture, an <code>alg</code> field must be present in an enclosing structure, and the nearest instance present determines the hash algorithm.</p>
</li>
<li>
<p>If no <code>alg</code> field is found in any of these locations, the claim must be rejected.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Compute the hash of the ingredient manifest&#8217;s data using that algorithm.</p>
</li>
<li>
<p>Compare the computed hash with the value in the <code>hash</code> field. If the hashes are not equal, the claim must be rejected.</p>
</li>
<li>
<p>If the ingredient contains a <code>metadata</code> field, and that field contains a non-empty <code>reviewRatings</code> field, the ingredient&#8217;s claim is admitted. An admitted manifest is treated like an accepted manifest, but with an explicit indication that it may contain validation errors that are known to the signer. If the <code>reference</code> field is present, its contents are ignored, and the <code>reviewRatings</code> (if present and non-empty) still applies to the ingredient&#8217;s claim. If admitted in this way, the validator must present the contents of the <code>reviewRatings</code> field as part of any exploration of the provenance history. Validators should perform full validation if exploration of the provenance history of the ingredient is requested to indicate where there are validation errors.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The presence of a non-empty <code>reviewRatings</code> is an explicit statement by the signer that they acknowledge and override validation errors in the ingredient&#8217;s claim itself.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Otherwise, validate the ingredient claim and assertions as described beginning in <a href="#_validate_the_claim">Section 14.1, &#8220;Validate the Claim&#8221;</a>, except skip establishing signer credential trust, as this is not applicable to ingredients.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>When validating the assertions as described in <a href="#_validate_the_assertions_in_the_assets_claim">Section 14.5, &#8220;Validate the Assertions in the Asset&#8217;s Claim&#8221;</a>, provide <code>active_redacted_assertions</code> as an input.</p>
</li>
<li>
<p>The validator may optionally recursively verify the ingredient&#8217;s ingredients. If it does and those are accepted, the ingredient&#8217;s claim is accepted. If any are rejected, the ingredient&#8217;s claim is rejected. If the validator chooses not to recurse further, the ingredient&#8217;s claim is accepted.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_inability_to_access_external_uris">14.7. Inability to access external URIs</h3>
<div class="paragraph">
<p>During the validation process, a given URI reference may refer to an external location that needs to be resolved. However, there are various reasons that may prevent a validator from obtaining the necessary data at that URL - (a) validation device is offline, (b) service behind the URL is offline, (c) data is no longer present in the external device (e.g., cloud storage system), etc. Such a claim shall not be accepted at any time before all references can be resolved and the entirety of the claim validated, but validation may be deferred or an appropriate status indicating a temporary failure may be returned as suits the needs of the workflow performing validation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_visual_look_of_validation">14.8. Visual look of Validation</h3>
<div class="paragraph">
<p>Here is a visual representation of the process of validating a claim (and its assertions).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/Claim_Validation.svg" alt="Validating a Claim" width="720" height="432">
</div>
<div class="title">Figure 9. Validating a Claim</div>
</div>
</div>
<div class="sect2">
<h3 id="_validate_the_assets_content">14.9. Validate the Asset&#8217;s Content</h3>
<div class="paragraph">
<p>For any portions of an asset rendered for presentation to a user, including but not limited to audio, video, or text, the corresponding hard bindings corresponding to the rendered content must be validated in accordance with <a href="#_hard_bindings">Section 8.2, &#8220;Hard Bindings&#8221;</a>. If at any time content fails to be validated, the validator must clearly signal to the user that some of the content does not match the claim, and if possible should indicate what part of the content did not validate. If any content is absent for which content bindings exist, discovery of this absence is also a validation failure. The validator must continue to report validation has failed, even if later portions of the content validate correctly.</p>
</div>
<div class="paragraph">
<p>For content that is not wholly available before rendering begins, such as during adaptive bitrate streaming (ABR) and progressive download, absence of not-yet-available portions of content is not considered a validation failure. As the content becomes available, the validator must validate each portion of the content before it is rendered as previously described. In addition, the validator must validate that the sequence of said content is the same as when the manifest was produced. Unless the player has explicitly signalled the validator that a discontinuity is expected (e.g., when the consumer performs a manual seek operation via the UI), the validator must clearly signal to the user that an unexpected discontinuity has occurred whenever the sequence does not match.</p>
</div>
<div class="paragraph">
<p>For content that is intentionally not being rendered as the claim generator originally intended, such as during fast-forward, rewind, or playback at a different speed, the validator may not be able to validate the content. In this case, the validator must clearly signal to the user that the content cannot be validated during the corresponding operation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_user_experience">15. User Experience</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_principles">15.1. Principles</h3>
<div class="paragraph">
<p>C2PA user experience recommendations aim to define best practices for presenting the provenance captured in C2PA systems to consumers. These recommendations are provided as a companion document to this specification (TODO: create link to UX Recommendations).</p>
</div>
<div class="paragraph">
<p>These recommendations strive to describe standard, readily recognizable experiences that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>provide asset creators a means to capture information and history about the content they are creating, and</p>
</li>
<li>
<p>provide asset consumers information and history about the content they&#8217;re experiencing, thereby empowering them to understand where it came from and decide how much to trust it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>C2PA consumer user interfaces must be informed by the context of the asset for which they display C2PA data. We have studied 4 primary user groups and a collection of contexts in which C2PA assets are encountered. These user groups are Consumers, Creators, Publishers and Verifiers (or Investigators). To serve the needs of each of these groups across common contexts, exemplary wireframed user interfaces are presented for many common cases. These are recommendations, not mandates, and we expect best practices to evolve.</p>
</div>
</div>
<div class="sect2">
<h3 id="_disclosure_levels">15.2. Disclosure Levels</h3>
<div class="paragraph">
<p>Because the complete set of C2PA data for a given asset can be overwhelming to a user, we describe 4 levels of progressive disclosure which guide the designs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Level 1: An indication that C2PA data is present and its cryptographic verification status. Should invite the user to learn more.</p>
</li>
<li>
<p>Level 2: A summary of C2PA data available for a given asset. Should provide enough information for the particular content, user, and context to allow the consumer to understand to a sufficient degree how the asset came to its current state.</p>
</li>
<li>
<p>Level 3: A detailed display of all relevant provenance data. Note that the relevance of certain items over others is contextual and determined by the UX implementor.</p>
</li>
<li>
<p>Level 4: For sophisticated, forensic investigatory usage, a standalone tool capable of revealing all the granular detail of signatures and trust signals is recommended.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_common_applications_and_use_cases">15.3. Common Applications and Use Cases</h3>
<div class="paragraph">
<p>TODO: list the use cases that are in scope for the UX Recommendations document.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_information_security">16. Information security</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_threats_and_security_considerations">16.1. Threats and Security Considerations</h3>
<div class="paragraph">
<p>Information security is a principal concern of C2PA. C2PA maintains a threat model and security considerations for the C2PA core specification. This effort complements other security-related work within C2PA. The C2PA is developing security considerations documentation that includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A summary of relevant security features of C2PA technology</p>
</li>
<li>
<p>Security considerations for use of C2PA technology</p>
</li>
<li>
<p>Threats to C2PA technology and respective treatment of those threats, including countermeasures</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This documentation is currently in development. A draft version of this content is expected to be included in a future public release of C2PA material.</p>
</div>
</div>
<div class="sect2">
<h3 id="_harms_and_misuse">16.2. Harms and Misuse</h3>
<div class="paragraph">
<p>The work on Harms and Misuse is ongoing. This section of the specification summarizes the process that is being carried out, in addition to serving as a placeholder for version 0.7.</p>
</div>
<div class="paragraph">
<p>To consider and address potential harms that may stem from the C2PA standard, a revised and adapted version of <a href="https://docs.microsoft.com/en-us/azure/architecture/guide/responsible-innovation/harms-modeling">Microsoft&#8217;s Harms Modelling Framework</a> is being utilized.</p>
</div>
<div class="paragraph">
<p>At this stage, the process is being run internally, starting with</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Defining the Purpose</p>
</li>
<li>
<p>Describing use-cases</p>
</li>
<li>
<p>Considering stakeholders</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The next stage is the harm assessment of C2PA based on a revised version of the Harms Taxonomy Framework.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c2pa_standard_assertions">17. C2PA Standard Assertions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_2">17.1. Introduction</h3>
<div class="paragraph">
<p>This section of the document lists the standard set of assertions for use by C2PA implementations, describing their syntax, usage, etc. To keep things simple, all example JUMBF URIs have been shortened for illustrative purposes - full URIs are necessary in the actual data.</p>
</div>
<div class="paragraph">
<p>All C2PA standardized assertions use either the CBOR JUMBF content type or the Embedded File content type from ISO 19566-5:AMD-1. Entity-specific assertions can be either of those, any of the other JUMBF content types from ISO 19566-5, B.1 (i.e., JSON or XML) or may create its own (as per the instructions in ISO 19566-5, Table B.1).  The Codestream content type shall not be used for a C2PA assertion.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
CBOR is not currently defined in 19566-5, but an upcoming update will define the type as <code>cbor</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Unless otherwise mentioned, all assertions documented in this standard set of assertions shall be serialized as CBOR. For all assertions that are either of type CBOR or JSON, we will describe their schemas using JSON Schema.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Editor&#8217;s Note</div>
<div class="paragraph">
<p>A future update may switch to use <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All assertions shall have a label as described in <a href="#_labels">Section 5.2, &#8220;Labels&#8221;</a> and shall be versioned as described in <a href="#_versioning">Section 5.3, &#8220;Versioning&#8221;</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_use_of_cbor">17.2. Use of CBOR</h3>
<div class="paragraph">
<p>All CBOR encoded data in a C2PA manifest shall comply with the <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-core-deterministic-encoding">"Core Deterministic Encoding Requirements" of CBOR</a>.</p>
</div>
<div class="paragraph">
<p>When converting JSON data, based on one of the JSON Schemas documented here, to CBOR for the purposes of including as a valid C2PA assertion, the following shall be done:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A JSON <code>null</code> shall be serialized as Null (major type 7, additional information 22).</p>
</li>
<li>
<p>A JSON <code>false</code> shall be serialized as False (major type 7, additional information 20).</p>
</li>
<li>
<p>A JSON <code>true</code> shall be serialized as True (major type 7, additional information 21).</p>
</li>
<li>
<p>A JSON number shall be serialized either as an integer (major type 0 or 1) or a floating-point value (major type 7, additional information 25 through 27).</p>
</li>
<li>
<p>A JSON string that does not have an alternate semantic type (e.g., date-time or uri) shall either be serialized as a UTF-8 string (major type 3), if human consumable, or a byte string (major type 2) if not. For Base64-encoded strings, they shall be encoded in CBOR as a byte string (major type 2) after decoding from Base64.</p>
</li>
<li>
<p>A JSON string that is identified as a <code>date-time</code> shall be serialized with <a href="https://www.rfc-editor.org/rfc/rfc8949.html#stringdatetimesect">tag 0</a> (major type 6)</p>
</li>
<li>
<p>A JSON string that is identified as a <code>URI</code> shall be serialized with <a href="https://www.rfc-editor.org/rfc/rfc8949.html#stringdatetimesect">tag 32</a> (major type 6)</p>
</li>
<li>
<p>A JSON array shall be serialized as an array (major type 4).</p>
</li>
<li>
<p>A JSON object shall be serialized as a map (major type 5), with each key being serialized as a UTF-8 string (major type 3).</p>
</li>
<li>
<p>Indefinite-length items (additional information 31) shall not be used.  Accordingly, break codes (major type 7 and additional information value 31) shall not be used.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The above list is based on an inversion of <a href="https://www.rfc-editor.org/rfc/rfc8949.html#name-converting-from-cbor-to-jso">section 6.1 of CBOR</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_assertion_metadata">17.3. Assertion Metadata</h3>
<div class="paragraph">
<p>In many cases, it is useful or even necessary to provide additional information about an assertion such as the date-time that when was generated or other data that may help manifest consumers to make informed decisions about the provenance or veracity of the assertion data. This is accomplished using the schema provided below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/assertion-info/v1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion that describes additional information about an assertion, including a hashed-uri reference to it"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"reviewRatings"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nl">"explanation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Content bindings did not validate"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"date-time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-06-28T16:34:11.457Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"definitions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"RATING"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"minimum"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="nl">"maximum"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A value from 1 (worst) to 5 (best) of the rating of the item"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"explanation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A human readable string explaining why the rating is what it is"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"value"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"reviewRatings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An array of review ratings.  May be empty"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/RATING"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The rating given to the assertion"</span><span class="w">
      </span><span class="p">}</span><span class="w">

    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"date-time"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date-time"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The ISO 8601 date-time string when the assertion was created/generated"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"reference"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/hashed-uri/v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hashed_uri reference to another assertion that this review is about"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In most cases, this assertion specific metadata will appear directly inside of other assertions as the value of their <code>metadata</code> field. However, assertions not in JSON or CBOR, such as thumbnails, will need their information stored as a separate, independent, <code>assertion metadata</code> assertion. The label for the <code>assertion metadata</code> assertion is <code>c2pa.assertion.metadata</code>.</p>
</div>
<div class="paragraph">
<p>The <code>reviewRatings</code> array (which may be empty) provides a place for the claim generator to provide a rating on the quality (or lack thereof) of an assertion. The <code>value</code> field can have any value from <em>1</em> (worst) through <em>5</em> (best) and the <code>explanation</code> field shall contain a human-consumable string description of type of rating.</p>
</div>
<div class="paragraph">
<p>Because the <code>reference</code> field of the <code>assertion metadata</code> assertion is a standard <a href="#_uri_references"><code>hashed_uri</code></a>, it is also possible to have an <code>assertion metadata</code> assertion refer to assertions in other manifests than the active one. For example, the active manifest could include an <code>assertion metadata</code> assertion that validates the <code>precise location</code> assertion present in an ingredient&#8217;s manifest.</p>
</div>
</div>
<div class="sect2">
<h3 id="_standard_c2pa_assertion_summary">17.4. Standard C2PA Assertion Summary</h3>
<div class="paragraph">
<p>The standard C2PA assertions are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Assertion</th>
<th class="tableblock halign-left valign-top">Schema</th>
<th class="tableblock halign-left valign-top">Serialization</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.data.hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BMFF-based Hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cc2pa.bmff.hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Soft Binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.soft.binding</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.cloud.data</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thumbnail</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.claim.thumbnail (claim creation time) c2pa.ingredient.thumbnail (importing an ingredient)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD - Need a better definition below</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Broad Location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.location.broad</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Precise Location</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.location.precise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camera Information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.camera.information</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.actions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ingredient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.ingredient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GDepth Depthmap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.depthmap.GDepth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developers.google.com/depthmap-metadata/reference" class="bare">https://developers.google.com/depthmap-metadata/reference</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Claim Review</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema.org.ClaimReview</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schema.org ClaimReview</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creative Work</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">schema.org.CreativeWork</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Schema.org CreativeWork</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSON-LD</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_data_hash">17.5. Data Hash</h3>
<div class="paragraph">
<p>Portion(s) of a non-BMFF-based asset that a claim generator wishes to uniquely identify with a hard binding (aka cryptographic hash) shall be described using data hash assertions. The types of hashes which can be created and stored in such an assertion are described in <a href="#_hashing">Section 12.1, &#8220;Hashing&#8221;</a>. Because each data hash assertion defines a byte range and optional URL, it is flexible enough to be usable whether the asset is a single binary or represented in multiple chunks or portions, local or remote.</p>
</div>
<div class="paragraph">
<p>A Data Hash assertion shall have a label of <code>c2pa.data.hash</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://json-schema.org/">JSON Schema</a> for this type looks is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/data-hash/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The data structure used to store the cryptographic hash of some or all of the asset's data and additional information required to compute the hash."</span><span class="p">,</span><span class="w">
    </span><span class="nl">"definitions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"EXCLUSION_RANGE"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Starting byte of the range"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"length"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Number of bytes of data to exclude"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"start"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"length"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"exclusions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> 
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="mi">9960</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"length"</span><span class="p">:</span><span class="w"> </span><span class="mi">4213</span><span class="w">
                </span><span class="p">}</span><span class="w"> 
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JUMBF manifest"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"alg"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA="</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pad"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"       "</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"hash"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pad"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"exclusions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"minItems"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/EXCLUSION_RANGE"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A string identifying the cryptographic hash algorithm used to compute the hash in this assertion, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default."</span><span class="w">
        </span><span class="p">},</span><span class="w">        
        </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CBOR byte string of the hash value"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"pad"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CBOR byte string used for filling up space"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) a human-readable description of what this hash covers"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
			</span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) a file or http(s) URL to where the bytes that are being hashed can be found.  This is useful for cases where the data lives in a different file chunk or side-car than the claim."</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Normally, the <code>start</code> and <code>length</code> values shall be written in their preferred serialization (i.e., "as short as possible"), however, when data hash assertion needs to be created but they are not yet known, they shall be created "as large as possible", which would be as a 32-bit integer. The <code>pad</code> value shall always be present but shall be a byte string of length 0 unless used to replace (aka "pad") bytes during multiple pass processing.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<a href="#_multiple_step_processing">Section 9.4, &#8220;Multiple Step Processing&#8221;</a> describes how fill in the correct values and adjust the padding.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_bmff_based_hash">17.6. BMFF-Based Hash</h3>
<div class="paragraph">
<p>Portion(s) of a BMFF-based asset that a claim generator wishes to uniquely identify with a hard binding (aka cryptographic hash) shall be described using BMFF-based Hash assertions.</p>
</div>
<div class="paragraph">
<p>A BMFF-based Hash assertion shall have a label of <code>c2pa.bmff.hash</code>.</p>
</div>
<div class="paragraph">
<p>To create the hash specified in the value field of a bmff hash, all bytes of the file are added to the hash excluding those BMFF boxes which match any exclusion entry in the exclusions array.  Any box included in the hash also includes its box headers; any box excluded from the hash also excludes its box headers.</p>
</div>
<div class="paragraph">
<p>A box matches an exclusion entry in the exclusions array if and only if all of the following conditions are met.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The box&#8217;s location in the file exactly matches the exclusion entry&#8217;s xpath field.</p>
</li>
<li>
<p>If length is specified in the exclusion entry, the box&#8217;s length exactly matches the exclusion entry&#8217;s length field.  Note: The length includes the box headers.</p>
</li>
<li>
<p>If version is specified in the exclusion entry, the box is a FullBox and the box&#8217;s version exactly matches the exclusion entry&#8217;s version field.</p>
</li>
<li>
<p>If flags (byte array of exactly 3 bytes) is specified in the exclusion entry, the box is a FullBox and the box&#8217;s flags (bit(24), i.e., 3 bytes) exactly matches the exclusion entry&#8217;s flags field.</p>
</li>
<li>
<p>If data (array of objects) is specified in the exclusion entry, then for each item in the array, the box&#8217;s binary data at that item&#8217;s offset field exactly matches that item&#8217;s bytes field.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The xpath syntax shall be limited to the following strict subset.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Only abbreviated syntax shall be used.</p>
</li>
<li>
<p>Only full paths shall be used.</p>
</li>
<li>
<p>Only node selection via <code>node</code> or <code>node[integer]</code> shall be used.</p>
</li>
<li>
<p>Descendent syntax, i.e., <code>//</code>, shall NOT be used.</p>
</li>
<li>
<p>All nodes shall be BMFF <code>4cc</code> codes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Complete Syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>  xpath = '/' nodes
  nodes = node
        | node '/' nodes
  node = box4cc
       | box4cc '[' integer ']'
Where:
  box4cc is any 4cc allowed by ISO/IEC 14496-12 for a BMFF box.
  integer is any non-zero positive integer with no leading zeros.</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the manifest is embedded into the file, the box containing it shall be one of the entries in the exclusions array and all file offsets shall be excluded wherever they appear.  Refer to <a href="#_embedding_manifests_into_bmff_based_assets">Section 10.2.2, &#8220;Embedding manifests into BMFF-based assets&#8221;</a> for more information.</p>
</div>
<div class="paragraph">
<p>Because the box that contains the manifest is at the root and always excludes file offsets, the hash can be computed before the manifest is created and the manifest can then be added without changing any existing portion of the file or invalidating the hash.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/bmff-hash/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The data structure used to store the cryptographic hash of a BMFF-format asset's data and additional information required to compute the hash"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"exclusions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"xpath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/moov[1]/pssh"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"xpath"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/emsg"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"r3avWCpXHkmKHATFsV0Q5g"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example BMFF-hash object"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EiAuxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"exclusions"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"hash"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"exclusions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"minItems"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"xpath"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Location of box(es) to exclude from the hash starting from the root node as an xpath formatted string of version https://www.w3.org/TR/xpath-10/ with highly constrained syntax"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"/moov[1]/pssh"</span><span class="p">,</span><span class="w"> </span><span class="s2">"/emsg"</span><span class="w"> </span><span class="p">]</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"length"</span><span class="p">:</span><span class="w">  </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) Length that a leafmost box must have to exclude from the hash"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="nl">"offset"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="w">
                                </span><span class="p">},</span><span class="w">
                                </span><span class="nl">"bytes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                                    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CBOR byte string"</span><span class="w">
                                </span><span class="p">}</span><span class="w">
                            </span><span class="p">},</span><span class="w">
                            </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"offset"</span><span class="p">,</span><span class="w"> </span><span class="s2">"value"</span><span class="w"> </span><span class="p">],</span><span class="w">
                            </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"r3avWCpXHkmKHATFsV0Q5g"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
                            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) The data in the leafmost box at the specified offset must be identical to the specified data for the box to be excluded from the hash"</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"subset"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                                </span><span class="nl">"offset"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="w">
                                </span><span class="p">},</span><span class="w">
                                </span><span class="nl">"length"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="w">
                                </span><span class="p">}</span><span class="w">
                            </span><span class="p">},</span><span class="w">
                            </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"offset"</span><span class="p">,</span><span class="w"> </span><span class="s2">"length"</span><span class="w"> </span><span class="p">],</span><span class="w">
                            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) Only this portion of the excluded box shall be excluded from the hash.  Each entry in the array must have a monotonically increasing offset.  No subset within the array may overlap."</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) Version that must be set in a leafmost box for the box to be excluded from the hash.  Shall only be specified for a box that inherits from FullBox"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"flags"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) CBOR byte string of exactly 3 bytes.  The 24-bit flags that must be set in a leafmost box for the box to be excluded from the hash.  Shall only be specified for a box that inherits from FullBox."</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"minLength"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"maxLength"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"xpath"</span><span class="w"> </span><span class="p">],</span><span class="w">
                </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Any leafmost box(es) matching this exclusion will not be hashed except for any portion included in the subset array"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A string identifying the cryptographic hash algorithm used to compute this hash, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken from an enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default."</span><span class="w">
        </span><span class="p">},</span><span class="w">        
        </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hash of the entire BMFF file excluding boxes listed in the exclusions array.  If the merkle field is present, this hash also excludes all 'mdat' boxes."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"EiAuxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"merkle"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A set of merkle tree rows and the associated data required to enable verification of a single 'mdat' box or multiple 'mdat' boxes within the asset."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"minItems"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"uniqueId"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1-based unique id used to differentiate across files to determine which merkle tree should be used to verify a given 'mdat' box."</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"localId"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Local id used to differentiate across multiple 'mdat' boxes within a single file to determine which merkle tree should be used to verify that 'mdat' box."</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"count"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Number of leaf nodes in the Merkle tree.  Null nodes are not included in this count."</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A string identifying the cryptographic hash algorithm used to compute the hashes in this merkle tree, taken from the C2PA hash algorithm identifier list. If this field is absent, the hash algorithm is taken the `alg` value of the enclosing structure as defined by that structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default."</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="nl">"hashes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An ordered array representing a single row of the Merkle tree which may be the leaf-most row, root row, or any intermediate row.  The depth of the row is implied by (shall be computed from) the number of items in this array."</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"minItems"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                            </span><span class="nl">"description"</span><span class="p">:</span><span class="w">  </span><span class="s2">"A single hash in a single row of the Merkle tree."</span><span class="w">
                        </span><span class="p">}</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"uniqueId"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"localId"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"count"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"hashes"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) a human-readable description of what this hash covers"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) a file or http(s) URL to where the bytes that are being hashed lived.  This is useful for cases where the data lives in a different file chunk or side-car than the claim."</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A pseudo-code implementation of this algorithm follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>offset = 0
While (offset &lt; length of file)
	Starting at offset, locate the first byte of the first box that matches any entry in the exclusions array, call this first_excluded_byte
		If no such box is found, set first_excluded_byte = length of file
	Determine the length of that box, call this excluded_byte_count
		If no such box was found, set excluded_byte_count = 0
	To the hash, add all bytes between offset and first_excluded_byte minus one (inclusive)
	If first_excluded_byte &lt; length of file and there exists a subset array within the exclusion that determined the value of first_excluded_byte
		set next_included_begin = first_excluded_byte
		For each entry in the subset array within the exclusion that determined the value of first_excluded_byte
			Set next_excluded_begin = this subset array entry's offset field plus first_excluded_byte
			If next_excluded_begin &gt; next_included_begin
				To the hash, add all bytes between next_included_begin and next_excluded_begin minus one (inclusive)
			Set next_included_begin  = this subset array entry's length field plus next_excluded_begin
		If next_included_begin &lt; first_excluded_byte + excluded_byte_count
			To the hash, add all bytes between next_included_begin and first_excluded_byte + excluded_byte_count minus one (inclusive)
	Set offset = first_excluded_byte + excluded_byte_count</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_exclusion_list_profiles">17.6.1. Exclusion list profiles</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Editor&#8217;s Note</div>
<div class="paragraph">
<p>A set of recommended exclusions for various types of media would go here&#8230;&#8203;</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_soft_binding_2">17.7. Soft Binding</h3>
<div class="paragraph">
<p>If a claim generator wishes to provide a soft binding for the asset&#8217;s content, it shall be described using soft binding assertions. The types of soft bindings which can be created and stored in such an assertion are described in <a href="#_hashing">Section 12.1, &#8220;Hashing&#8221;</a>. Because each soft binding assertion provides for an optional URL, it is flexible enough to be usable whether the asset is a single binary or represented in multiple chunks or portions, local or remote.</p>
</div>
<div class="paragraph">
<p>A Soft Binding assertion shall have a label of <code>c2pa.soft.binding</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://json-schema.org/">JSON Schema</a> for this type looks is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/soft-binding/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The data structure used to store one or more soft bindings across some or all of the asset's content"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"definitions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"SOFTBINDING_TIMESPAN"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"time"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Start of the time range over which the soft binding value has been computed."</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"end"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"time"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"End of the time range over which the soft binding value has been computed."</span><span class="w">
                </span><span class="p">}</span><span class="w">

            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> 
                </span><span class="s2">"start"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"end"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"SOFTBINDING_SCOPE"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"extent"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) CBOR byte string describing, in algorithm specific format, the part of the digital content over which the soft binding value has been computed"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"timespan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                     </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/SOFTBINDING_TIMESPAN"</span><span class="w">
                </span><span class="p">}</span><span class="w">

            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> 
            </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"SOFTBINDING_BLOCK"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"scope"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                  </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/SOFTBINDING_SCOPE"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CBOR byte string describing, in algorithm specific format, the value of the soft binding computed over this block of digital content"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"value"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"scope"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://xxx"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"alg"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"phash"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"alg-params"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pad"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"       "</span><span class="p">,</span><span class="w">
            </span><span class="nl">"blocks"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="w">
                     </span><span class="nl">"scope"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"VGhpcyBpcyBzb21lIHRleHQgdG8gY29udmVydCB2aWEgQ3J5cHQu"</span><span class="p">,</span><span class="w">
                     </span><span class="nl">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Ab452JshB4wkdB42N2Mq33Nr53N2543W532wsmSDfPo5okK6mnwaM"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="w">
                     </span><span class="nl">"scope"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"343kjlk3j4kln3kj4nrkj3n4kj43nkjn4kjn43kjn43kjn43n4n3"</span><span class="p">,</span><span class="w">
                     </span><span class="nl">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Pwselrfkjsdlkfjsdklfjmklsjkljrewkljwlkejflksjdflksjds"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"alg"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"blocks"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"pad"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A string identifying the soft binding algorithm and version of that algorithm used to compute the value, taken from the C2PA soft binding algorithm identifier list. If this field is absent, the algorithm is taken from the `softbinding-alg` value of the enclosing structure. If both are present, the field in this structure is used. If no value is present in any of these places, this structure is invalid; there is no default."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"alg-params"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) CBOR byte string describing parameters of the soft binding algorithm. If this field is absent, the algorithm is taken from the `softbinding-alg-params` value of the enclosing structure, if present."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) a human-readable description of what this hash covers"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"pad"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CBOR byte string used for filling up space"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"(optional) a file or http(s) URL to where the bytes that are being hashed lived.  This is useful for cases where the data lives in a different file chunk or side-car than the claim."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"blocks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"minItems"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/SOFTBINDING_BLOCK"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cloud_data">17.8. Cloud Data</h3>
<div class="paragraph">
<p>There are use cases where storing the data for the assertion remotely, such as in the cloud, is better than embedded inside the asset, especially when the data is large. For any such cases, it is possible to use a special type of assertion that serves as a reference to that information.</p>
</div>
<div class="paragraph">
<p>A Cloud Data assertion shall have a label of <code>c2pa.cloud.data</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://json-schema.org/">JSON Schema</a> for this type looks is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/cloud-data/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion that references the actual assertion data stored outside the asset (eg. in the cloud)"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c2pa.claim.thumbnail.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">98765</span><span class="p">,</span><span class="w">
            </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://some.storage.us/foo"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DjZifCgG2iKxcYeChKTOcWlJ9I/UC9/c5XFiJREqJFpwA="</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"content_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/jpeg"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"label"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"size"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"location"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"content_type"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"label for the cloud-based assertion (eg.c2pa.claim.date.v1)"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Number of bytes of data"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"minimum"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"multipleOf"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.0</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/hashed-uri"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a file or http(s) URL to where the bytes that are being hashed can be found along with a hash of the bytes stored at that URL"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"content_type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"media/MIME type for the data"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pattern"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^[-</span><span class="se">\\</span><span class="s2">w.]+/[-+</span><span class="se">\\</span><span class="s2">w.]+$"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/assertion-info"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"additional information about the assertion"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_thumbnail">17.9. Thumbnail</h3>
<div class="paragraph">
<p>A <strong>thumbnail</strong> assertion provides an approximate visual representation of the asset at a specific event in the lifecycle of an asset. There are currently two specific events - ingredient import and claim creation - each using a unique label for the assertion.</p>
</div>
<div class="paragraph">
<p>For thumbnails created at claim creation time, the Thumbnail assertion shall have a label that starts with <code>c2pa.claim.thumbnail</code> and be followed by the <a href="https://www.iana.org/assignments/media-types/media-types.xhtml#image">IANA registry</a> image type (e.g., <code>c2pa.claim.thumbnail.png</code>). For each of these types of thumbnails, there can be only one per claim.</p>
</div>
<div class="paragraph">
<p>For thumbnails created as part of importing an ingredient (see <a href="#_adding_ingredients">Section 9.3.2.2, &#8220;Adding Ingredients&#8221;</a>), the Thumbnail assertion shall have a label that starts with <code>c2pa.ingredient.thumbnail</code> and be followed by an underscore (<code>_</code> (U+005F)) then a unique ID such as a simple monotonically increasing integer and ending with the image type. For example, an ingredient thumbnail of type <code>jpeg</code> could have label <code>c2pa.ingredient.thumbnail_1.jpg</code>.</p>
</div>
<div class="paragraph">
<p>The data in a thumbnail assertion is the bits of a file (such as a raster image) in whatever format is desired by the claim generator. The Embedded File content type (ISO 19566-5:AMD-1), <code>bfdb</code>, shall be used to contain the thumbnail&#8217;s data.</p>
</div>
</div>
<div class="sect2">
<h3 id="_location">17.10. Location</h3>
<div class="paragraph">
<p>A <strong>location</strong> assertion provides information about a location relevant to the asset in some way. All Location assertions shall have a label that starts with <code>c2pa.location</code> and be followed by a third section expressing more info about the location.</p>
</div>
<div class="paragraph">
<p>The schema for this type is defined by <a href="https://schema.org/Place">Schema.org&#8217;s Place schema</a>.</p>
</div>
<div class="sect3">
<h4 id="_broad">17.10.1. Broad</h4>
<div class="paragraph">
<p>A <strong>broad location</strong> assertion provides a broad or approximate location for the asset while avoiding revealing overly-specific information. It may only include some general information about the location.</p>
</div>
<div class="paragraph">
<p>A Broad Location assertion shall have a label of <code>c2pa.location.broad</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://json-schema.org/">JSON Schema</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/location-broad/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion to specify a broad location associated with the asset"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"San Francisco"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"location"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a broad or approximate location for the asset"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/assertion-info"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"additional information about the assertion"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_precise">17.10.2. Precise</h4>
<div class="paragraph">
<p>A <strong>precise location</strong> assertion provides best-known location information for the asset.</p>
</div>
<div class="paragraph">
<p>As such, any valid value defined in <a href="http://www.cipa.jp/std/documents/e/DC-008-2012_E.pdf">the EXIF standard</a> may be stored in the assertion. It is preferable to copy this information from the <code>EXIF</code> or <code>XMP</code> data (in the <a href="https://github.com/adobe/xmp-docs/blob/master/XMPNamespaces/exif.md">EXIF</a> namespace). When copying the information from XMP, the data shall be re-serialized according to the rules of the <a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a> and then serialized as CBOR.</p>
</div>
<div class="paragraph">
<p>If the data comes from other sources, such as a Schema.org <a href="https://schema.org/GeoCoordinates">GeoCoordinates structure</a>, then it should be transcoded to match.</p>
</div>
<div class="paragraph">
<p>A Precise Location assertion shall have a label of <code>c2pa.location.precise</code>.</p>
</div>
<div class="paragraph">
<p>A <em>limited</em> version of the <a href="https://json-schema.org/">JSON Schema</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/location-precise/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion to specify a precise location associated with the asset"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"exif:GPSVersionID"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.2.0.0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSLatitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39,21.102N"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSLongitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"74,26.5737W"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSAltitudeRef"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSAltitude"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100963/29890"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSTimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-09-22T18:22:57Z"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSSpeedRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"K"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSSpeed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4009/161323"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSImgDirectionRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"T"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSImgDirection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"296140/911"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSDestBearingRef"</span><span class="p">:</span><span class="w"> </span><span class="s2">"T"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSDestBearing"</span><span class="p">:</span><span class="w"> </span><span class="s2">"296140/911"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"exif:GPSHPositioningError"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13244/2207"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"exif:GPSLatitude"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exif:GPSLongitude"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"exif:GPSHPositioningError"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"exif:GPSAltitude"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS Altitude"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS tag 6, 0x06. Indicates altitude in meters."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"exif:GPSAltitudeRef"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS Altitude Ref"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS tag 5, 0x5. Indicates whether the altitude is above or below sea level: 0 = Above sea level, 1 = Below sea level"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"enum"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"exif:GPSAreaInformation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS Area Information"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS tag 28, 0x1C. A character string recording the name of the GPS area."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"exif:GPSLatitude"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS Latitude"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS tag 2, 0x02 (position) and 1, 0x01 (North/South). Indicates latitude."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"exif:GPSLongitude"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS Longitude"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS tag 4, 0x04 (position) and 3, 0x03 (East/West). Indicates longitude."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"exif:GPSTimeStamp"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS Time Stamp"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS tag 29 (date), 0x1D, and, and GPS tag 7 (time), 0x07. Time stamp of GPS data, in Coordinated Universal Time."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date-time"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"exif:GPSHPositioningError"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS Horizontal Positioning Error"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GPS tag 31, 0x1F. Indicates horizontal positioning errors in meters"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/assertion-info"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"additional information about the assertion"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As the EXIF specification supports a variety of other GPS-related values, they may also be included in a precise location assertion.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_camera_information">17.11. Camera Information</h3>
<div class="paragraph">
<p>The <strong>camera information</strong> assertion would be used to ensure that the information about the capture device is added to the asset in an authentic manner. It is preferable to copy this information from the <code>EXIF</code> or <code>XMP</code> data (in the <a href="https://github.com/adobe/xmp-docs/blob/master/XMPNamespaces/exif.md">EXIF</a> and/or <a href="https://github.com/adobe/xmp-docs/blob/master/XMPNamespaces/crs.md">Camera Raw</a> namespaces). When copying the information from XMP, the data shall be re-serialized according to the rules of the <a href="https://www.iso.org/standard/79384.html">JSON-LD serialization of XMP</a> and then serialized as CBOR.</p>
</div>
<div class="paragraph">
<p>A Camera Information assertion shall have a label of <code>c2pa.camera.information</code>.</p>
</div>
<div class="paragraph">
<p>A <em>limited</em> version of the <a href="https://json-schema.org/">JSON Schema</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/camera_info/v1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion that describes information from the capture device at the point of capture."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"crs:HasCrop"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"crs:WhiteBalance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"As Shot"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"crs:Saturation"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nl">"crs:Sharpness"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"crs:LuminanceSmoothing"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"crs:ColorNoiseReduction"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"exif:ColorSpace"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"exif:DigitalZoomRatio"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"exif:LensMake"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Apple"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"exif:LensModel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iPhone 7 Plus back dual camera 3.99mm f/1.8"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"exif:LensSpecification"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4183519/1048501 33/5 9/5 14/5"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"crs:HasCrop"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"boolean"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"When true, image has a cropping rectangle."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"crs:WhiteBalance"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"White Balance setting."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enum"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"As Shot"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Auto"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Daylight"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Cloudy"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Shade"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Tungsten"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Fluorescent"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Flash"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"Custom"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"crs:Saturation"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Saturation setting. Range -100 to 100."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"minimum"</span><span class="p">:</span><span class="w"> </span><span class="mi">-100</span><span class="p">,</span><span class="w">
      </span><span class="nl">"maximum"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"crs:Sharpness"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sharpness setting. Range 0 to 100."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"minimum"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"maximum"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"crs:LuminanceSmoothing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Luminance Smoothing setting. Range 0 to 100."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"minimum"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"maximum"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"crs:ColorNoiseReduction"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Color Noise Reduction setting. Range 0 to 100."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"minimum"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nl">"maximum"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"exif:ColorSpace"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXIF tag 40961, 0xA001. Color space information:1 = sRGB, 65535 = uncalibrated"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"enum"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">65535</span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"exif:DigitalZoomRatio"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXIF tag 41988, 0xA404. Indicates the digital zoom ratio when the image was shot. 0 = digital zoom not used."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"exif:LensMake"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXIF tag 42035, 0xA433. The lens manufacturer."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"exif:LensModel"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXIF tag 42036, 0xA434. The lens's model name and model number as an ASCII string."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"exif:LensSpecification"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXIF tag 42034, 0xA432. This tag notes minimum focal length, maximum focal length, minimum F number in the minimum focal length, and minimum F number in the maximum focal length, which are specification information for the lens that was used in photography. When the minimum F number is unknown, the notation is 0/0."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/assertion-info"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"additional information about the assertion"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">},</span><span class="w">
  </span><span class="nl">"patternProperties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"^(crs|exif):\\w+$"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_actions">17.12. Actions</h3>
<div class="paragraph">
<p>An <strong>actions</strong> assertion provides information on edits and other actions taken that affect the asset&#8217;s content. There will be an array of actions - each action declaring <em>what</em> took place on the asset, <em>when</em> it took place, along with possible other information such as what software performed the action.</p>
</div>
<div class="paragraph">
<p>An Actions assertion shall have a label of <code>c2pa.actions</code>.</p>
</div>
<div class="paragraph">
<p>Actions are modeled after the <a href="https://github.com/adobe/xmp-docs/blob/master/XMPNamespaces/XMPDataTypes/ResourceEvent.md">XMP ResourceEvent</a> schema, as defined in the <a href="https://www.adobe.com/content/dam/acom/en/devnet/xmp/pdfs/DynamicMediaXMPPartnerGuide.pdf">Partners Guide to XMP for Dynamic Media</a>, and are represented as:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 69%;">
<colgroup>
<col style="width: 48%;">
<col style="width: 26%;">
<col style="width: 26%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>action</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>complex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>changed</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>instanceID</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>parameters</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>softwareAgent</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>when</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The value of <code>action</code> will be either a well-known common action name (<code>c2pa.resized</code>, <code>c2pa.edited</code>, etc.) or entity-specific action name (<code>adobe.ps.gaussian_blur</code>, etc.).</p>
</div>
<div class="paragraph">
<p>The set of defined names, prefixed with <code>c2pa.</code> are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 26%;">
<col style="width: 56%;">
<col style="width: 18%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">Meaning</th>
<th class="tableblock halign-left valign-top">Source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.converted</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.copied</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.created</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.cropped</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.edited</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.filtered</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.formatted</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.version_updated</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.printed</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.published</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.managed</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.produced</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.resized</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.saved</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.transcoded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A direct conversion of one encoding to another, including resolution scaling, bitrate adjustment and encoding format change. Does not include any adjustments that would affect the "editorial" meaning of the content.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.repackaged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A conversion of one packaging or container format to another. Content may be repackaged without transcoding. Does not include any adjustments that would affect the "editorial" meaning of the content.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c2pa.placed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added/Placed an ingredient into the asset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C2PA</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition, an action may include a <code>actor</code> key which can point to the <a href="#_identity">identity</a> of the human actor who performed the action. The value of the <code>actor</code> key is an object with a single key: <code>credential</code>. The <code>credential</code> key&#8217;s value is an array of <a href="#_uri_references"><code>hashed_uri</code></a>, which can point to a Verifiable Credential in the <a href="#_VCStore">Credential Store</a>.</p>
</div>
<div class="paragraph">
<p>When using a <code>c2pa.transcoded</code>, <code>c2pa.repackaged</code>, or a <code>c2pa.placed</code> action, the <code>parameters</code> field shall contain the JUMBF URI to the related ingredient assertion.</p>
</div>
<div class="sect3">
<h4 id="_asset_renditions">17.12.1. Asset Renditions</h4>
<div class="paragraph">
<p>Asset renditions are a common occurrence when distributing media on the internet. These renditions are often created for the purpose of delivering media to consumers in differing connectivity, screen resolution, and other environments. We can use the <code>actions</code> assertion to help consuming actors understand the intention of certain claim creators to create asset renditions.</p>
</div>
<div class="paragraph">
<p>The presence of only the <code>c2pa.transcoded</code> and/or <code>c2pa.repackaged</code> actions in a <code>c2pa.actions</code> assertion provides a signal to the manifest consumer that the signer is asserting that no "editorial" changes have happened between the ingredient asset(s) and this one. Editorial changes are those that alter the intent and/or meaning of the content.</p>
</div>
<div class="paragraph">
<p>The additional presence of a single "parentOf" ingredient provides a further signal to the manifest consumer that the signer is asserting that the asset has been derived directly from that parent.</p>
</div>
</div>
<div class="sect3">
<h4 id="_schema_and_example">17.12.2. Schema and Example</h4>
<div class="paragraph">
<p>The <a href="https://datatracker.ietf.org/doc/html/rfc8610">CDDL Definition</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cddl">actions-array = [
  1* action-items-map
]

buuid = #6.37(bstr)

$action-choice /= "c2pa.converted"
$action-choice /= "c2pa.copied"
$action-choice /= "c2pa.created"
$action-choice /= "c2pa.cropped"
$action-choice /= "c2pa.edited"
$action-choice /= "c2pa.filtered"
$action-choice /= "c2pa.formatted"
$action-choice /= "c2pa.version_updated"
$action-choice /= "c2pa.printed"
$action-choice /= "c2pa.published"
$action-choice /= "c2pa.managed"
$action-choice /= "c2pa.produced"
$action-choice /= "c2pa.resized"
$action-choice /= "c2pa.saved"
$action-choice /= "c2pa.transcoded"
$action-choice /= "c2pa.repackaged"
$action-choice /= "c2pa.placed"

actor-map = {
  ? "credential": [1* $hashed-uri-map]
}

action-items-map = {
  "action": $action-choice,
  "when": tdate, ; Timestamp of when the action occurred. For events that create or write to a file, this should be the approximate modification time of the file.
  ? "softwareAgent": tstr, ;The software agent that performed the action.
  ? "changed": tstr, ; A semicolon-delimited list of the parts of the resource that were changed since the previous event history. If not present, presumed to be undefined. When tracking changes and the scope of the changed components is unknown, it should be assumed that anything might have changed.
  ? "instanceID": buuid, ; The value of the xmpMM:InstanceID property for the modified (output) resource
  ? "parameters": tstr, ; Additional description of the action
  ? "actor": [1* actor-map], ; An array of the creators that undertook this action
  ? "metadata": $assertion-info-map, ; additional information about the assertion
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An example in CBOR-Diag is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c2pa.filtered"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"when"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="err">(</span><span class="s2">"2020-02-11T09:00:00Z"</span><span class="err">)</span><span class="p">,</span><span class="w">
    </span><span class="nl">"softwareAgent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Adobe Photoshop 2020 for Windows"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"changed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"change1,change2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"instanceID"</span><span class="p">:</span><span class="w"> </span><span class="mi">37</span><span class="err">(h'ed</span><span class="mi">610</span><span class="err">ae</span><span class="mi">51</span><span class="err">f</span><span class="mi">604002</span><span class="err">be</span><span class="mi">3</span><span class="err">dbf</span><span class="mi">0</span><span class="err">c</span><span class="mi">589</span><span class="err">a</span><span class="mi">2</span><span class="err">f</span><span class="mi">1</span><span class="err">f')</span><span class="p">,</span><span class="w">
    </span><span class="nl">"actor"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"credential"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.credentials/Joe_Bloggs"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="err">b</span><span class="mi">64</span><span class="err">'hoOspQQ</span><span class="mi">1</span><span class="err">lFTy/</span><span class="mi">4</span><span class="err">Tp</span><span class="mi">8</span><span class="err">Epx</span><span class="mi">670E5</span><span class="err">QW</span><span class="mi">5</span><span class="err">NwkNR+</span><span class="mi">2</span><span class="err">b</span><span class="mi">30</span><span class="err">KFXug='</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ingredient">17.13. Ingredient</h3>
<div class="paragraph">
<p>When assets are composed together, for example placing an image into a layer in Photoshop or an audio clip into a video in Premiere, it is important that information about any claim from the placed asset be recorded into the new asset to provide a way to understand the entire history of the new composed asset. This is also true when an existing asset is used to create a derived asset or asset rendition.</p>
</div>
<div class="paragraph">
<p>An Ingredient assertion shall have a label of <code>c2pa.ingredient</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since there will most likely be more than one ingredient assertion, the use of the monotonically increasing index in the label would be used (e.g., <code>c2pa.ingredient__1</code>, <code>c2pa.ingredient__2</code>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is modelled on the XMP Ingredient and Pantry model, as described in the <a href="https://wwwimages2.adobe.com/content/dam/acom/en/devnet/xmp/pdfs/DynamicMediaXMPPartnerGuide.pdf">Partner Guide to XMP for Dynamic Media</a> and <a href="http://wwwimages.adobe.com/content/dam/acom/en/products/xmp/Pdfs/XMPAssetRelationships.pdf">Asset Relationships in XMP</a>. That model relies on the fact that each asset used in the construction of a document has, at the time of inclusion, at least one <a href="#_unique_identifiers">unique identifier</a>.</p>
</div>
<div class="paragraph">
<p>If the ingredient being added contains XMP, then asset&#8217;s <code>xmpMM:DocumentID</code> becomes the <code>stRef:DocumentID</code> field while the <code>xmpMM:InstanceID</code> becomes the <code>stRef:InstanceID</code>. However, if the ingredient being added does not have any associated XMP then, if possible, it shall be created and added to the ingredient itself and the identifiers used as described above.</p>
</div>
<div class="paragraph">
<p>When it is not possible or desirable to create XMP for an ingredient, then some other <a href="#_unique_identifiers">unique identifier</a> for the ingredient shall be used instead for the required values. In this situation, the <code>stRef:InstanceID</code> field shall contain the unique identifier and the <code>stRef:DocumentID</code> field shall not be present.</p>
</div>
<div class="paragraph">
<p>When adding an ingredient, its relationship to the current asset shall be described. These are the possible values of the relationship field and their meanings:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>parentOf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current asset is a derived asset or asset rendition of this ingredient.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>componentOf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current asset is composed of multiple parts, this ingredient being one of them.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The value of <code>dc:title</code> shall be a human-readable name for the ingredient, which may be taken either from the asset&#8217;s XMP or the asset&#8217;s name in a local or remote (e.g., cloud-based) filesystem. The type/format of the ingredient shall be present in <code>dc:format</code>.</p>
</div>
<div class="paragraph">
<p>If the ingredient has an existing C2PA Manifest, then that manifest shall be copied into the C2PA Manifest Store for the asset. The <a href="#_uri_references">URI reference</a> to that <a href="#_c2pa_box_details">C2PA Manifest</a> shall be stored as the value of <code>c2pa_manifest</code>.</p>
</div>
<div class="paragraph">
<p>It is recommended that, if it is technically able to, the processor validate the content hard bindings (i.e., hashes) provided in the claim and provide a <code>review</code> of them as part of the <a href="#_assertion_metadata">assertion metadata</a>. When present, the assertion metadata shall contain at least one entry in the <code>reviewRatings</code> array, whose <code>value</code> field has a value which is either <em>1</em> (did not validate) or <em>5</em> (successfully validated). No other values are permitted for the <code>value</code> in this use of reviews.</p>
</div>
<div class="paragraph">
<p>The <a href="https://json-schema.org/">JSON Schema</a> for this type looks is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/ingredients/v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion that describes an ingredient used in the asset"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"dc:title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image 1.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"dc:format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"stRef:DocumentID"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid:87d51599-286e-43b2-9478-88c79f49c347"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"stRef:InstanceID"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid:7b57930e-2f23-47fc-affe-0400d70b738d"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"c2pa_manifest"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/urn:uuid:5E7B01FC-4932-4BAB-AB32-D4F12A8AA322"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Arx031oA0N5KOEG6n9R/bJJFYJvmGlDoLtuwbRipLTKAA="</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"thumbnail"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=cp2a/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.ingredient.thumbnail_1.jpg"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DjZifCgG2iKxcYeChKTOcWlJ9I/UC9/c5XFiJREqJFpwA="</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"relationship"</span><span class="p">:</span><span class="w"> </span><span class="s2">"parentOf"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"reviewRatings"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
                        </span><span class="nl">"explanation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Content bindings validated"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">],</span><span class="w">
                </span><span class="nl">"date-time"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-06-28T16:49:32.874Z"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"dc:title"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dc:format"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"stRef:InstanceID"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"relationship"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"metadata"</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"dc:title"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name of the ingredient"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"dc:format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"media type of the ingredient"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"stRef:DocumentID"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value of the ingredient's `xmpMM:DocumentID`"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"stRef:InstanceID"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value of the ingredient's `xmpMM:InstanceID`"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"relationship"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The relationship of this ingredient to the asset it is an ingredient of. For example, if an ingredient with a 'parentOf' relationship is added to an asset, then the asserter is stating that the current asset is a derived asset of the ingredient."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"enum"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"parentOf"</span><span class="p">,</span><span class="w"> </span><span class="s2">"componentOf"</span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"c2pa_manifest"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/hashed-uri"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hashed_uri reference to the C2PA Manifest of the ingredient"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"thumbnail"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/hashed-uri"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"hashed_uri reference to an ingredient thumbnail"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/assertion-info"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"additional information about the assertion"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
    </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When adding an ingredient, it may be useful to also include a thumbnail of the ingredient to help establish the state of the ingredient at the time of import. For that purpose, an ingredient import thumbnail should be added as described in <a href="#_thumbnails">[_thumbnails]</a> and referenced herein via a URI reference.</p>
</div>
</div>
<div class="sect2">
<h3 id="_depthmap">17.14. Depthmap</h3>
<div class="paragraph">
<p>A Depthmap assertion provides a 3D description of the scene being captured by a camera. A Depthmap assertion may contain a pre-computed <a href="https://en.wikipedia.org/wiki/Depth_map">depth map</a>, or data which can later be used to compute a depth map by downstream ingestion or viewing software (e.g., left/right stereo images).</p>
</div>
<div class="paragraph">
<p>All Depthmap assertions shall have a label that starts with <code>c2pa.depthmap</code> and be followed by a third section that identifies the type of depth map.</p>
</div>
<div class="paragraph">
<p>C2PA Depthmap assertions shall be captured optically, not inferred from a single 2D image via, for example, a machine learning model.</p>
</div>
<div class="sect3">
<h4 id="_gdepth_depthmap">17.14.1. GDepth Depthmap</h4>
<div class="paragraph">
<p>A GDepth depth map assertion leverages the well-established <a href="https://developers.google.com/depthmap-metadata/reference">GDepth format</a> to encode a pre-computed depth map.</p>
</div>
<div class="paragraph">
<p>A GDepth Depthmap assertion shall have a label of <code>c2pa.depthmap.GDepth</code>.</p>
</div>
<div class="paragraph">
<p>The schema for the data stored in this assertion should always mirror the schema at <a href="https://developers.google.com/depthmap-metadata/reference" class="bare">https://developers.google.com/depthmap-metadata/reference</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is no need to worry about splitting up the GDepth data when it grows beyond 64KB, as that limit existed in XMP to accommodate APP1 segment size limitations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="https://json-schema.org/">JSON Schema</a> for this type is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/depthmap-GDepth/v1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion that encodes a GDepth-formatted 3D depth map of the captured scene"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"GDepth:Mime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:Format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RangeInverse"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:Near"</span><span class="p">:</span><span class="w"> </span><span class="mf">29.3</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:Far"</span><span class="p">:</span><span class="w"> </span><span class="mf">878.7</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:MeasureType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OpticalAxis"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:ConfidenceMime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:Software"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Truepic Foresight Firmware for QC QRD8250 v0.01"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:Units"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mm"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:Data"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iVBORw0KGgoAAAANSUhEUgAAAtAAAAPACAYAAAA..."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"GDepth:Confidence"</span><span class="p">:</span><span class="w"> </span><span class="s2">"iVBORw0KGgoAAATNSUhEUgBAAtAAAACCA..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"GDepth:Format"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"GDepth:Near"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"GDepth:Far"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"GDepth:Mime"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"GDepth:Data"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"GDepth:Format"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The format that describes how to convert the depthmap data into a valid float-point depthmap. Current valid values are 'RangeInverse' and 'RangeLinear'"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RangeInverse"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Near"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The near value of the depthmap in depth units."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Far"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The far value of the depthmap in depth units."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Mime"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The mime type for the base64 string describing the depth image content, e.g. 'image/jpeg' or 'image/png'"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/jpeg"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The base64 encoded depth image. Please see GDepth encoding page at developers.google.com. The depthmap will be stretched-to-fit the corresponding color image."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Units"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The units of the depthmap, e.g. 'm' for meters or 'mm' for millimeters."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"m"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:MeasureType"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The type of depth measurement. Current valid values are 'OpticalAxis' and 'OpticRay'."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OpticalAxis"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:ConfidenceMime"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The mime type for the base64 string describing the confidence image content, e.g. 'image/png'."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"image/png"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Confidence"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The base64 encoded confidence image. Please see GDepth encoding page at developers.google.com. The confidence map should have the same size as the depthmap."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Manufacturer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The manufacturer of the device that created this depthmap."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Model"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The model of the device that created this depthmap."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:Software"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The software that created this depthmap."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:ImageWidth"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The width in pixels of the original color image associated to this depthmap. This is NOT the depthmap width. If present, apps must update this property when scaling, cropping or rotating the color image. Clients use this property to verify the integrity of the depthmap w.r.t. the color image."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"GDepth:ImageHeight"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The height in pixels of the original color image associated to this depthmap. This is NOT the depthmap height. If present, apps must update this property when scaling, cropping or rotating the color image. Clients use this property to verify the integrity of the depthmap w.r.t. the color image."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.adobe.com/c2pa/assertion-info"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"additional information about the assertion"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">},</span><span class="w">
  </span><span class="nl">"additionalProperties"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_of_schema_org">17.15. Use of Schema.org</h3>
<div class="paragraph">
<p><a href="https://schema.org/">Schema.org</a> is a collaborative, community activity with a mission to create, maintain, and promote schemas for structured data on the Internet. As such, they provide numerous JSON-based grammars that one may wish to include as an assertion. When using a schema.org type as a C2PA assertion, we require a full JSON-LD serialisation. As such, the top-level <code>@context</code> field must have a value of <code><a href="http://schema.org" class="bare">http://schema.org</a></code>.</p>
</div>
<div class="paragraph">
<p>All Schema.org assertions shall have a label that starts with <code>schema.org</code> and be followed by the name of the schema that is being used. For example, <code>schema.org.ImageObject</code> can be used to include something extra about an image. Since schemas on <a href="https://schema.org/">Schema.org</a> are not versioned as described <a href="https://schema.org/docs/howwework.html">here</a>, no version indicator is used in their labels.</p>
</div>
<div class="sect3">
<h4 id="_claim_review">17.15.1. Claim Review</h4>
<div class="paragraph">
<p>A schema that is used by the publishing community for web sites has <a href="https://www.blog.google/products/search/bringing-fact-check-information-google-images/">recently also been introduced for images</a>. A <a href="https://schema.org/ClaimReview">ClaimReview</a> is used as 'A fact-checking review of claims made (or reported) in some creative work (referenced via itemReviewed).'</p>
</div>
<div class="paragraph">
<p>A ClaimReview assertion shall have a label of <code>schema.org.ClaimReview</code>.</p>
</div>
<div class="paragraph">
<p>Inside the assertion (which, as described previously, is serialised as JSON-LD), the top-level <code>@type</code> field should be set to a value of <code>ClaimReview</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The "Claim" in ClaimReview refers to a "claim made (or reported) in some creative work", not the C2PA claim block. ClaimReview assertions should be used as a way to mark the current asset as a review of the claims of another work, not any specific part of the C2PA manifest. To provide a review of a specific assertion, use an <a href="#_assertion_metadata">assertion metadata assertion</a>.</p>
</div>
<div class="paragraph">
<p>An an example: an image infographic has been assembled that fact-checks some other claim that is currently in public distribution. The image infographic includes a ClaimReview assertion which references the text of the claim its reviewing, a fact-checking rating of the claim, and zero to many links to other works (e.g., articles, videos, images) that are making that claim.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The reviewRating property inside the ClaimReview assertion is of type <a href="https://schema.org/Rating">Rating</a>. Depending on how your organisation does fact-checking reviews, you may have a numerical rating, a true or false, or some other textual description of how the asset has reviewed a claim. <a href="https://www.claimreviewproject.com/user-guide" class="bare">https://www.claimreviewproject.com/user-guide</a> provides a good guide on how to use the ClaimReview vocabulary.</p>
</div>
<div class="paragraph">
<p>A partial <a href="https://json-schema.org/">JSON Schema</a> for this type is:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This schema does not validate all aspects of the referenced schema.org types (just the top-level ClaimReview and Review properties). Please refer to <a href="https://schema.org" class="bare">https://schema.org</a> for the details on referenced types, and <a href="https://json-ld.org/" class="bare">https://json-ld.org/</a> for how to reference them in the assertion.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/claim_review/v1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion that describes a fact-checking review of claims made (or reported) in some creative work (referenced via itemReviewed)."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@context"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://schema.org"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ClaimReview"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"claimReviewed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The world is flat"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"reviewRating"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Rating"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ratingValue"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"bestRating"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"worstRating"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ratingExplanation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The world is not flat"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"alternateName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"False"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"itemReviewed"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CreativeWork"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"author"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Person"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A N Other"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"headline"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Earth: Flat."</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://json.schemastore.org/schema-org-thing.json"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"claimReviewed"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A short summary of the specific claims reviewed in a ClaimReview."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"reviewAspect"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Review: This Review or Rating is relevant to this part or facet of the itemReviewed."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"reviewBody"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Review: The actual body of the review."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"reviewRating"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Review: The rating given in this review. Note that reviews can themselves be rated. The reviewRating applies to rating given by the review. The aggregateRating property applies to the review itself, as a creative work."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://json.schemastore.org/jsonld#"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"itemReviewed"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Review: The item that is being reviewed/rated."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://json.schemastore.org/jsonld#"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_creative_work">17.15.2. Creative Work</h4>
<div class="paragraph">
<p>Schema.org provides a well-known and well-deployed set of types and metadata fields. One of the core types is <a href="https://schema.org/CreativeWork">CreativeWork</a>, which is intended to describe any representation of creative effort. This assertion allows an asserter to provide various pieces of information about the asset, including who they are, and the date/time of publication.</p>
</div>
<div class="paragraph">
<p>A Creative Work assertion shall have a label of <code>schema.org.CreativeWork</code>.</p>
</div>
<div class="paragraph">
<p>Inside the assertion (which, as described previously, is serialised as JSON-LD), the top-level <code>@type</code> field should be set to a value of <code>CreativeWork</code>. The JSON-LD document&#8217;s root subject is the bound asset of the claim that this assertion is part of.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://json-schema.org/draft-07/schema"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"$id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/creative_work/v1"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Assertion that describes the most generic kind of creative work, including books, movies, photographs, software programs, etc."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"examples"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"@context"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"http://schema.org/"</span><span class="p">,</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"credential"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"@type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CreativeWork"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"datePublished"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-05-20T23:02:36+00:00"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"publisher"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BBC News"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"publishingPrinciples"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.bbc.co.uk/news/help-41670342"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"logo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://m.files.bbci.co.uk/modules/bbc-morph-news-waf-page-meta/5.1.0/bbc_news_logo.png"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"parentOrganization"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BBC"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"legalName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"British Broadcasting Corporation"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.bbc.co.uk/news/av/world-europe-57194011"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"p09j7vzv"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"producer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://en.wikipedia.org/wiki/Joe_Bloggs"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Joe Bloggs"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"credential"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"self#jumbf=c2pa/acme:urn:uuid:F9168C5E-CEB2-4faa-B6BF-329BF39FA1E4/c2pa.credentials/Joe_Bloggs"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sha256"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"hash"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Auxjtmax46cC2N3Y9aFmBO9Jfay8LEwJWzBUtZ0sUM8gA"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"copyrightHolder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BBC"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"legalName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"British Broadcasting Corporation"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"copyrightYear"</span><span class="p">:</span><span class="w"> </span><span class="mi">2021</span><span class="p">,</span><span class="w">
      </span><span class="nl">"copyrightNotice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Copyright © 2021 BBC."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://json.schemastore.org/schema-org-thing.json"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"datePublished"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date-time"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: Date of first broadcast/publication."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"publisher"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: The publisher of the creative work."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/personOrgOrUri"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"identifier"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The identifier property represents any kind of identifier for any kind of Thing (in this case, an identifier for this CreativeWork)."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"producer"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: The person or organization who produced the work (e.g. music album, movie, tv/radio series etc.)."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/personOrgOrUri"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"creator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: The creator/author of this CreativeWork."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/personOrgOrUri"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"editor"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: Specifies the Person who edited the CreativeWork."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/person"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/uri"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"contributor"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: A secondary contributor to the CreativeWork or Event."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/personOrgOrUri"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"copyrightHolder"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: The party holding the legal copyright to the CreativeWork."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/personOrgOrUri"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"copyrightNotice"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: Text of a notice appropriate for describing the copyright aspects of this Creative Work, ideally indicating the owner of the copyright for the Work."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"copyrightYear"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"integer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/CreativeWork: The year during which the claimed copyright for the CreativeWork was first asserted."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"definitions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"credential"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Verifiable Credentials (VC) associated with this actor."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://ns.c2pa.org/hashed-uri/v1"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"organization"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Organization: An organization such as a school, NGO, corporation, club, etc."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The name of the Organization."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"legalName"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Organization: The official name of the organization, e.g. the registered company name."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"publishingPrinciples"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Organization: The publishingPrinciples property indicates (typically via URL) a document describing the editorial principles of an Organization (or individual e.g. a Person writing a blog) that relate to their activities as a publisher, e.g. ethics or diversity policies."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"logo"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Organization: An associated logo."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"parentOrganization"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Organization: The larger organization that this organization is a subOrganization of, if any."</span><span class="p">,</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/organization"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"credential"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/credential"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"person"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Organization: An organization such as a school, NGO, corporation, club, etc."</span><span class="p">,</span><span class="w">
      </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The name of the Person."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"givenName"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"From http://schema.org/Person: Given name. In the U.S., the first name of a Person."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"familyName"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Family name. In the U.S., the last name of a Person."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"credential"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/credential"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"personOrgOrUri"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"anyOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/organization"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/person"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/uri"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>As described in <a href="#_using_credentials">Section 7.3, &#8220;Using Credentials&#8221;</a>, it is possible to associate a W3C Verifiable Credential for an actor with a specific role in the Creative Work via the <code>url</code> property of that role&#8217;s value. However, because the <code>url</code> value can be any valid URL, it is also possible to use any valid identity URL (e.g., <a href="https://openid.net/connect/">OpenID</a> or <a href="https://www.w3.org/wiki/WebID">WebID</a>).</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
 DRAFT 0.6<br>
Last updated 2021-08-13 22:05:01 UTC
</div>
</div>
</body>
</html>